<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2020b"><title>Estimating context-dependent network in autoregressive point process models</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.S10 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Estimating context-dependent network in autoregressive point process models</span></h1><h2  class = 'S1'><span>Introduction</span></h2><div  class = 'S2'><span>This is a tutorial for how to use the MATLAB functions in this folder to conduct estimation for context-dependent networks from time series data, based on autoregressive point process modeling. The methodologies are proposed in the paper </span><a href = "https://arxiv.org/abs/2003.07429"><span>Context-dependent self-exciting point processes: models, methods, and risk bounds in high dimensions</span></a><span>, including a multinomial approach which assumes a multinomial autoregressive model, a logistic-normal approach that assumes a logistic-normal autoregressive model, and a mixture approach assuming some nodes in the network follow the multinomial model while others follw the logistic-normal model. </span></div><div  class = 'S2'><span>In this tutorial, we illustrate how to apply the multinomial, logistic-normal and mixture approaches through some examples.</span></div><h2  class = 'S1'><span>Multinomial method</span></h2><div  class = 'S2'><span>Assume that the time series data </span><span texencoding="\{X^t\in R^{M\times K}\}_{t=0}^T" style="vertical-align:-8px"><img src="data:image/png;base64,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" width="100" height="23" /></span><span> follow the multinomial autoregressive model defined in the paper, with network parameter </span><span texencoding="A^{MN}\in R^{M\times K\times M\times K}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="116.5" height="19" /></span><span> and offset parameter </span><span texencoding="\nu^{MN}\in R^{M\times K}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAAmCAYAAABDJpDoAAAJYklEQVR4Xu2bB7AsRRWGP1BAEAVFMFAqWUCCAVEMBBVRCYJFEiSZEFFAiwKzSBFNIEERSrQUFZCgJEkqUZIZUAQjwUQy51Sfdbqq6Tez7+3OzN5ddk4VdR93ZrpPn/77hP/0XYheegvMoQUWmsO5+6l7C9ADsAfBnFqgB+Ccmr+fvAdgj4E5tUAXAHTMR2ar+jvwtwGrXAJYJJ7/E/hLfJ90+zPwr+L7/BsfVb0zp4Ydw+Rt2LkNNR8KPLxioD8ACwNLFs/+CPwn/a4LAKrQzsD7gBWBk4HX1qz0scBNwGOAbwMHApcCOwDvBtYCDgPeVXz/XOAgYFPgo/HOb9uw5hSN0Yad21iue7gdcCSgY/gF8CHgxPj/fYD3h2M5AjgaEIT/ly4AmMa+ENgMuAR4Sc1KvwRsFXo8Dfhe9t4WwLmAwHoi8I9ijFcB+wHPbsOKUzxGUzu3tfTvA2vHnl+cDfrh2H9Beks5WVcAXBS4HlgD+Gn8LOfeDdgReCnwY2DV4oVDgK2Bp4ZH/Xzx/IPArwEXOKvShp213YsjAt03wJCrA84n0EpZGrgX+A3whHhoWP4k8Fdg7/CA83zYFQBfBGwDvBxYriIP0KOdA5wS7vp44M2FdtcCbwJuAK4Bnl8811t6qm6dMvR50AxLhtAqMV++I/4zevxuwPrasLP5940BEIFYBUIdydeAy8NplCptC3wR+AygY/H9TwMfj5+1S+gKgOYAKrs/sCHwaOD+0MI5DRuHA28BXhlh2HCbRNCeFaA7P4C8bnb6HgdcWeE1pwWLi0Xe+rZM4VMB12o+bPohuCyuTgIOACzQSmlq5zTek4DLAuwlCAXT1yNX3zI8WqmHOr4OeHUUkP5bIJrfD5SuAPgd4AXACRE+c/Do1VyU+ds9UUEJ0D9lmroQPYWFjF7UjfkE8MZ4x+fmfgJ4WkWP7iFSbgOeAvw3W4wpSCq+kmcp19rUzvl4VSBcMzzfzXEoDKdVcnvk6dcBj4+0Kd/P2j3qAoCG188CG4eXe3soL4hWAc4ErGLXAb4RJ2+TQsPPhfu+Kkp5N8hqy/zC8t4N+QLwlWlFX6QXph7KsRGW8+UYGg2HicaQUfh59kIbdi7N9+TYD6PVvsAZwA+AzetyuHAmvvNd4N/AMyOn/OqC7E0XAHwDsEyAT2+nkf2pB9PNS69cETSKHu4dgOV5Ermj5BES/2cot+gwdzoO+EmcsroTuSBrT+88BDC06FGfFZVc4iXrxvH9q4eZpOJdiyorecWQ6wEtRQ8nO6CYZ3l4kzS1c536gtD0yZ/ukxHIVKBO3gp8JPbQNejVzSmfHoAcaKYuAHg2YPj4VmysxYb5nqdq+Qi9KqX32wB4BqChkwiC90RemH5niL4zPICb5ngapqmsAOht9cjDiB7bwzSqaHcrxmWDXnJ9VZtsZekzRYojz6ma2rlOd8OuOZ+5qIVeXWGSvk800Avju9OA7cPpWIQ0BqBdDUvqX81vsOhoyPUYas1nPL2CS0pGklIvY6fDst38TwNbUOS5z3sj9OjpcpHQ3gO4IEJv+XwB1HvAKwLYMO76fh90jodCow/q3DiIntdwM6oYpr4ZH1tdWnCUogeRnFe0vYc32UkP3dTOVbqnnM+xpU7OC8dRB8KHxXNt4UGRq9Vz+r05oHn8oCq+koheLdy9BhBAK0d1U/JwLsCTbKfCMKrYmXhNFloMxQLN1stGgDmdYuVrONH7WFDk4sb4u5K0zDdNneQXRxX1cnxPuSdYnRfkgI06X/md9tJuit2fDxQvPAIwobdYs/qVyM89bht2LnVK1e4PIyXQIwsmvaEgqgKhjQbtp1MwT0xyKPBO4Cggr/TnsV9VCDbZNyxqFFthnjp/d3eF9Z8X75jfKRYfLiAZ19+5EJ/nishvuSBP2ceycZ1Pb6nHzb1iekVu8FFRMTYBw6eA3cPDWI22kUsOo49g8kAqeQfIAyG3KUAtMowQ2siwlktTO5e6SjILNA9lWXAMomhst70+wGZalGSpSDHM5416eYr1gLkH5YDHBM1hLrdejXWt3uzF3hWVnCHyZ1FgSDIr5oD2dt1kgW1BkZJvSWapGsOrYcix7HzY3bBnaN6Xyy4xhonvqLJSFDGGDUOE+o5T9G4CKxU6HmzzYyt8K17Dv8m/nkW7mB4kWbwFO5drTeHcHq7FkClSKYJQgFpc2J1SDxsHBwOGYbsjOh0Pinm1dwHs/1rgSapbiJoyzZPnDgKgk9VdBlBBlbBaWn+MuyeBa+JeAnMYFfQwp8cGv2yYD1t61wraQ6nYLfCg6yVSwm5HwSR+nOIeWuBUgS/poUe2e9Pqga0DoAlv2mRDhSeyFPk9vYl0wDRJyk88PKkQGFZ/wSIVNIroCQyryisCjO6D48n1eX1NbzioLzvKvBP5TR0ADaW6f0lfE/byPp6/+1HQF9PWi835t1E3pQkNI8cpS6BNtaM2VuREvWKm2OFpWuWPuraxflcHQOkJb6p4XcpLBaVY3Uir7DlWbduZLG20PNqoXJ4VvHnvsJLyT7+TyM4vWFhxGt7cE+kXq/4HvVQB0MrFO3iezr2iSMgNIUViCLJ3+csptJD3D788n3uKXS3LXnbK9fR2Juq5eBk3cYJ5/7wrfeZ83CoA2omQClE8sXnSuSsgheEtDPmraRSb5TbPPWh2F+xjjku84ZMiit0Xr5nlYvWY2ANZgCbV/rjW1GieKgB6A8NWmrmKpHQS+R4pE0OHxOj8ugWNFOv4YzkriyjzWCvAlId1Oa0VpPSLnRevpMtnlt0UmQUJcXk06RmLwaprWF3qOdaxqwBoxetVKpNgw4S3WryP5kbJCRoicm5qrAq3NJkbLXdlMaC3t+jq2hNqN0OsMujPFCTtE7NgHl6S0C2ZYDKGKQHo6fSUelr1Cumv2+xKyFcZdqUJHgxiq9HrRqYZ9jDl5AyJAnN+azQtGcSZlfYx3NuusnWlCPq6v2V5Thaa7SpZjIy7UzO2/S0BmJOkKuHCJW1tl6W8cGzKjWEiuxIeLNtyw8gwNMxOEUEsKnK5KEDvTehS9Mb2ZhVDcbruNIyOU/FuCUB7vrp/KQb5Pb3BOPKjuTaWHR89jwWYQLHjMki8cm460ktDC3RxH7ChSv3ns2SBHoCztNsTuNYegBO4KbOkUg/AWdrtCVxrD8AJ3JRZUqkH4Czt9gSutQfgBG7KLKnUA3CWdnsC1/o/uecoRWeuQAMAAAAASUVORK5CYII=" width="80" height="19" /></span><span>, then we can estimate</span><span texencoding="A^{MN}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAmCAYAAACYsfiPAAAEZklEQVRoQ+3YZahtVRQF4O+JioWNLajoUxETAxU7sRMVxVbsxgDrh6iIYjfoExX8YYsdWJjYjYmFioFiN+Oxtmy35+x7nuf47sF355972XududaYMeZYe5wpzMZNYXiNAf6/Z3wsw/9xhhPgmWt7/IQfW/acAdOU97/ge9Sfdfr9tJi+2x6TO8NTY2echIVxBfbqAnhuvIw58SyOwX1YDUdjSzyG1Ru/j98jcSDuLmtfrNZMbsDVvndhI9yLDbsAvhlbMJFYl8MLtXWpkq8wFZbH8w0f8+JtLIAv6+8GBXi6EUqzvmdK7iksiXfK3ybm3bAjNsZbWKyxYH2cg6VwOfZtvN8U+2HzpuNBAN4A1yAl2Iuth62xCebCTI0fLYhbi88zcSEOaqzJ84cL6PiYH1/X1pyLV3DZoAGnJ1NOiXR67YseEOewD+EorInZS3nmp0lAyv00HIxtSlnf1vD7HNbA/jgDh+K82ppXS8t8MGjAIYYLitO1StRHwlwd9pJCYMuiIpUDSokfhs8xYwnItzWnqYBUVPabAx/ivVpr5P0dWLrTQfop6dnwZtk0vhPtgGizHOZqrF2yeCw2w+1YFDcUFl6mMPCDWKfhcJ/SPqeU51did6RVHsCeWLyw+j/O0g/g9MmqWKl4TaZThm0WcklWUrLJZvozfy9FwB1fquTkMrqOw+kNhwlKyvjJ8nxFPI0bsS2uK4GPv4EBDsOmDzMTk+VYopsot9lNSGaeKQwacgr4jJgQT0o5lvmaYK6AtEBl4Yzsl2r4rfY84LN2kRK4JRChMjDAd+IenI2PMB8+xTwtaKOYXi+H/aPM1oDJiIp6WqUoqVlL/4YA4y9rKwvJHYLtGvvsiqtK7/7Q4f1fy/9NSWecVDMwUYyaqcRDG1NnfKW/diq7p7RDTL8XAnq0PA8zp2yvxS4NYGH4zOUmV0QHhJGzf5RbFFxHm1TAydJLhRBuKR7PwhHl/2TgkS57haxew6m199+V/q1+n1dRXxEWmQAX1dZGsESobI/HO+yRXo/8TGt8PCjAh5feW7fmcI9aRDsxdYT8+ci6dxFCyliJpYd3QMowPZjZXFVAiCiZTLbGI9mNcspvErSKtKqjLITrERLrapOS4ZTLG4WY6tp15drmAZYeGy0LmaXkBwL44nJV27vhLdLwm6KSemHq0QrGxH17zXBUSxj1s8KkzUNnHMTXJ8hNZWitV8D3l9mZ4d7JwtoZK7Gw79+uZMOEvhfAWxW2TH/ki0MnqxRT3rUx9ahjHwlw5ltuHpFybTo5RBWpGcs9NFJxKG0kwCeUQZ7s/tqCIF8vcq2L9aKpRy0YbYCjR/MtKffM3GraLLeTyMbYE0UHjxqoto27AZ6lXAYiBvJdqXkBb/qMeMgtJZZKyCeZ3FGHzjoBjppJP+brX+x95LKQPv25gSDMnLkc/ZsvF5VF107AicOGeKQeHrbz9n2eMcB9h3DIHYxleMgT1PfxxjLcdwiH3MFYhoc8QX0f70+g6tYn2WtWzAAAAABJRU5ErkJggg==" width="30" height="19" /></span><span> and </span><span texencoding="\nu^{MN}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAAmCAYAAABkpNNFAAAEE0lEQVRoQ+3YZ8i2YxgH8N8rIyPhtSIf7ET2yCYzIeQNWSF7hGRkfhAystcXyixlREbxwSYzo+zxwcqMbEL/t+Oq673e+749yTPup/v4cj/PdZ7XeR7/8ziO//E/rxmmoc2YhpiMQA1LVEeRGmOkclCLtub+hl8HvLsQ5qvxP/Bzvd8c+E/4s/N++50MzTFnPCI1L/bHuVgRN+GwPqCWwZtYEq/gNDyGfXAW1sIFOLPz/mY4DzvgyprzZTNnPEA1az+CnfAoduwD6j7szmzCWhevtebtigcQZ1fA75019sOJ2KS79niBmh8vYA18WL/dvQ/GvtgZ72PVzoTzsQfWrMjf0Rm/BF/gsokCtR32xC5YGot0Ns7J34/bcCmuxXGdOc/jGLyI57BFZzxRnYV3JwpUHH0Cp2ArLIHvavNkR1LzQhyPvSoFk2qN5SDuKSAP1uGsg9drwrJ4qkd0Zw+PV/q9ii1xQ6VO26GcftIy9fA1Fi7QP7ZAHVAOh2wS7QC7EUfVnIynlnIoc9l4gEpq3YptKhqnI0Ufx1bB3Qh7rY1n8Ti27Xh2O67H05gH7yFMuRx+wC24Ew9PFKgjMLMAJSqpl/zmpAMgVP1kUXIicQYuajnXgFi91Z+SxiGGE3ANPigC+WWiQN2LMNfL2K0IIfWTmlq+0i6+JEqbYn0kXRvbCGdXnTXPUpOf4GOEyrNe0rKnjSX9og6S95/3W6T1PMrg7Uqzv6v3xOHQe1RA6iCKYbGqp2+Qos/cxs7BtxWR9pZp4ofgoUq7RGzMoFbD3livnFoZKcxun2iIJh0/KRRLhz+0TjP/Jw1DBn9h66qRPA/jpbZSO1m7bS/VsxxO2zZAxmLxKf1vzKBSkEmJi0um5BTz7KseK2xec1IvsRDEWyVbmunRZRk/ufV+VMb2OBbXtZ5HFiWqyYx29Jop6V2LI/XW1wal31VFmamNDfuscHVpr0+Rv5MeHxUJpLHG0mSj5VLUOawUfeoilsYa2k9qpWFHx0VBRCVcUXXU3vrAWuOk/wrqjQGCMmsuWA1240Eb/M9jC2CpHmDn2KZfpMJSYZtYaiEU3LX0n5UQCp9S1g9U0igpkUaXYu/eZ/LsnWqic2mvyUbYD1S6dRR0rgYRpl27vCj6yMkG0Gv/XqDS0XOHSTSOrkJuvxsKjoQJA302LKDS0UOrsdRM2Kyxg3BzXRdyS52S1itSuTpH5kREphE3dnhF7Zm6yQ767jCpYHuBCtPl2hAZku8AUdunItSdnpV+8v2kev0vm3dBRedFj+XjSZiv+SqU7p5mnJTL16EpbV1QjapunI4KuKukTFNnUxpQnOuCisZLM43sSf/J9TkRGyoby9VjqAD1itTQAejl8ChSwxLGUaRGkZrEE5iW6fcPQF/JJ2z83sYAAAAASUVORK5CYII=" width="26.5" height="19" /></span><span> by applying the functions in the folder </span><span style=' font-weight: bold;'>multinomial.</span></div><div  class = 'S2'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Generate data:</span></div><div  class = 'S2'><span>First we consider an example with </span><span texencoding="M=10" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAAAkCAYAAACUjSQ7AAAFiklEQVRoQ+2ZdagtVRTGfw/riSjGM1Cxuzuwu7s7EcQubMX2D8WngogtIgp2YHe3YisGdrfYxU/WXPYd55zZ5573x5znLHi8e+/svWfv9e211re+GUVrjfXAqMburN0YLTgNvgQtOC04DfZAg7fWRk4LToM9MPKtzQm83cP0SQDnTA48C/xRNzcnclYFtoZh5OFPYN+6xZPnmwDrlsY/BlzRwxpNGbo+cALwVcWZqvY4AXAisDfwGvAWsAbwFHAc8HKng+WA49xpgVOBPZOFxsQG65w2K/AiMEUM/AzYAhCcv+smN+j5WuHk5WJPd2aAo38vBXaJC35NzJ0MeByYHlgNeLXqnLngOHdn4PJkkcWBF2qc5/r3AKsn4w4Ezm6Q03O2cjDwE/ArcEkP4JwD7AdcB2xZetFSwBPAl8DSwAfljfQCjsBsA5g7tY2BW2pOZuo7Hpg4iZzZgPdyPNLQMZ8AMwB1kTMP8EacYfkAonykuwAj8kzg0JGCI4hu6oEAyHX2Ac7r4sC5I7JOjpToUDc7X0Odnrsta4aFvQ6c04AjIuKmBH6veMExwEnA18DMwM/pmNzIWQJ4GrAY3hELnA4c2eFEFsGHgQ+B+xMQTWemtUG2HHA8//vAjMC9wJodDrwS8FA82z3q09DQXHCOjjRmKvs0Zl8J7NjhpYcDhwALAhcAm8Y4wb19kJEJtlUXOQsBL8U5zwX273DmqRNSZS3bYySR8whwX9SPX6KGiPgqFS9dGHgG2B64KV4uU7OYuhkL6yBbTuSsk2QY05aUucomTNLd3cDavYJjvpRR2O8Iko3XHMC78X+63kTAk8CbwLbACjHHMbI2i99IzfxtXu7HvogepZ81csDZLWF1FnoLfif7EZBa/6ce56S1rYCLgGmiq5UUGDEWOJlb2qvYbO0V6cwmzd+PjV0dBpzRh1eeBxbrY75TvVhz9blGDjhFofdV9oYXd3nnR1GbzCiCNGQ54JgLjZ7NY5ZdfVFrLHiyOE2ubmOpmnBD/E0ev2z8vEiSh0fiH99v49uPfQ9c3c8CmTXnKOCUeM+upf6w/Pp3gNnj4ttyDF32HHA+jgg4P1ZVKShYmo5XhhgNPAd4u3eIcVMBphGZi2vM1KdTmjI9J3JkXkW0HADYjHYyM4y12AgalrbrwFk0epWixvgCNaKiv7Hrtfs1p0oAZGdyds1nhVxxGWAeHh8sB5wNgFvjsDbhpvcq0/+WBy+wJMrsM2R14FiEpXc2lIVtmCgDB4XCah3aDLg5GXdhosVtNw7SSVOAzQHH2mgW0c4ClH+qTBb7XTxQbbFVyQbnwagTqQJdRJOL2MPYYD0a2lu6thLNLMBfwHSZImk3AAaJrXnpbcCtydeH0Ft1NtsORWHNiz42FxxJgDVDBTmNiLRx0vGqzKazb5KF5wVej99VFpYZB9d+kNiax1UNsfnUh6rPVQq8l94m1U8w1puiwf/XXd3S2k4hJ1jYfyg5t+Dm/nmjJL8Ww1RiiyIogVBh6NcGia151hVDwvJnL2/VZ4Fr4/IrgNq4DrNu4NwGqCAvUOFVo8LoUKmWKpat6IX8u8XRtcYXK1TpSoeWDqnEJVGqqjum/FcAVQI/qfh9JwuclQHrjczLj2VGSmpKDfMDakjflp4JhsWtAH69RMoYdICWDAHYsylsSpR+63Iom3RlLz/QGUkpAKrafhGV1d5YtUY5cpRfpMn2KpPGBGWaq0qpSQ5vSKYiprVJZufn6HTdz6MplXIL6iCat99L5hkLv3gOxU2zgtKU/6rMr8j6y+iwOfdTteupuCjtGF2VVkelB9GRTd2zSrbsTKLlhVc9UQzuaC04TYWyhq01eNv/j621kdNgnFtwWnAa7IEGb62NnBacBnugwVtrI6fB4PwDMlUeNL1TCQkAAAAASUVORK5CYII=" width="51.5" height="18" /></span><span> nodes, and </span><span texencoding="K=2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFEAAAAkCAYAAADxYNZEAAAD40lEQVRoQ+3Yd+h9cxzH8cfP5g8j4x/ZKXtFZCcre0QUKTNkp0j4w/gD2dlkS2SVkJWszJKVUUKJ7JVsvfS5Ol3n3nPce/O7t867vn987+fzeZ/353ne573m6GRsAnPG1tAp0EGcgBN0EDuIEyAwARWdJ3YQJ0CgXsXyWA7v4vOmpzR54q7YAfMOUHQfHilr52KJmn3P4+YmQ6ZgfUGchcOxWMWej3EKbh9kYxPEnFsEV+CgipL8n783+xRnz43lt/dxFB7HH1MAaZgJgfYs1sSf+A3z9x24HMfUKWkDMed2w/1FwcvYqEZZvPUB7ITbcAR+nHJ4PfOux1Y4vrz0X7AKjsWRmKds3B6P9t+pLcSzcVo5nAdd0qdoYdyCncuDr50ReDFzXTyBDfFBjd2nIqEqcif2GxXiM9isHF4Db1cUrYC7sDj2wWszBDCmnoGvcdkAu/NZf4Kl8A5WGwVi4HxRkkuCbDJXT/ZEPoW4+KH4fsYAxtzzC8ifhtj+JLbGh1hxFIh74+5y8AYcUpLNRSXZnFiSzAzya23yPYjDBOY2o0C8BoeVg4kH75V0HzffF6+0NmV2N75YkulxuHQUiHHh3id8Hk7A09gL306YyzqlThtX7U14aVwl5fyi+BS/YiV89V8hro63yqHExQTXyBtYD79PyNCemt2RAn5cORC3jquknD+4xP2jB4WtphIn5UxiXyRlTjwlNWMkhfSVEzK0pyaZPh3SuJKSJcX+uJLS7fVS+qRGTCH+L2mC+HDlUlvgs+KFC5SMvSq+GdfSKT5/Tkkomw675zCIC5XvP2/jOyxZ2qELcFK5+MUlRk4xh5FN2wVXIc5TV4T/o3gYxLhvb7iQlm+Pcip9ZjL00iXYrl2K0JGtncKDife5c0Dmcx4qwyBeWPGy/qCavjhvKfJgeVjTs9qsT0N2Ts/8EJKcXmhj9DCImdCkxYsk9lUDdYYNr5ZEk/UdK17b5rmD9szt7LwsHkOcJsmpTuYrVUrKnr9lEMQMJD8qexIPVq7Rtm1lopFeOl6UEdI4Mjezc8JTxnanVyZWdXc5s9z7uSaIGUxeXTZdV+lY+pU+hS3Lj7XV/DhE/8ezifNp6RL/Bg1fl8F22ABrVW2r88T8FsqblI2ZDR4w4ELpYE4uaxk+bNw34fkfOYz8qAydk0A3b6khs4Je7Vz7OcebMp1ev6IwXcm9uANpxCP7l7Yv88OUQD35oQxm8zaTcGZBcrde5dFk789I3PyyyRObFHXrfQSaOpYOWAsCHcQWkJq2dBCbCLVY7yC2gNS0pYPYRKjFegexBaSmLR3EJkIt1juILSA1bfkLAO+mJcb/v84AAAAASUVORK5CYII=" width="40.5" height="18" /></span><span> categories, each node is influenced by </span><span texencoding="\rho=1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAAkCAYAAADB7MdlAAACsklEQVRoQ+3ZXehNaRTH8Y9EUfJyIZShJuU1FyIuhQxTw5BE4ZZMeUkp74zbGWpCbpimRsoIJUW4ciHceblCMl5DiQgpWjwnp9M+57+P8//X+Z+zn6tz9l7nedb+nrWe33rW7qEYuQn0yG1ZGCpg1REEBawCVh0E6jAtIquAVQeBr6Y/4k5Hv2r3yJqLnXiBnwpY2QRmYRempttnC1jZoNbjLd7jUAGro3z6dv8xhqCIrBzMbqfNvYDVLLAGYwSe4V4Op5rVpEsjaxXm4Tp64zfEgstwpVmJ1PCrS2AFmAOYiJ/xNDnwJ9bhJcbjYU5gCzE9p20tsy1p7e+dqktgHcEcjMOjMs8C3On0fQmO5vR6D9bmtK1lNhwPGpin02H9glNYiYMVjoXshvzG+AMbcjo+DRNy2tYy+xdvGpinU2H1xy30wTC8q3AsIu1GuhbREgVfdxqdCmsN9mJf2swrQSzA8XRxNfZ3J1JJnOIQ3Sl11jVMQpylzmeA2IHt+ISRuN+usMbiZkq9gRkp2DO1NaLeOolf6wDVcmq4G5txATMzQJRSMNobsXeVyok8zFpODaPInIytCHDloxcuYQoW4b88hMpsWkoNB+A5ItVm4GIFjMNYkSBuqxNUM5mXug7nMLsjx6p1SufjRPpxqMXd9Dnsf08113Kc6WiBJr4fwnWVL68DQ5hG4UMtf6vB+iuVCtEkC1mNSPoBi1PFvBH/NzGIWq4tTaeREJmoH0sjzrvx54fqZyl/1ZesUYiOwSYcw+iUlnH9VTeF1LDbWZEVlXrpQBwb8eWGV2mRCbJgRbvlH7zGIHxskWdt+DGyYP2dlC7yN7oKxShTt3IYfdPGHREVpUFEWDGqwIpOaByGn6S2cU0pbTeKlWk4FP3SflXqU7Ubk6rP2+6v7+sKhAJWHbg+A/SYiSXz/0jbAAAAAElFTkSuQmCC" width="37.5" height="18" /></span><span> randomly chosen node. Each edge weight follows uniform distribution </span><span texencoding="U(-2,2)" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="57" height="19" /></span><span>, and the offset parameter is set to ensure the event probability to be </span><span style=' font-family: monospace;'>prob=0.8</span><span> when no past influence exists.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>addpath(</span><span style="color: rgb(170, 4, 249);">'multinomial'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>M=10;K=2;rho=1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>rng(2578);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>A=zeros(M,K,M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:M</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    connect=randsample(M,rho);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>k=1:size(connect)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>     A(i,:,connect(k),:)=(rand(K,K)-0.5)*4;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>prob=0.8;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>nu=ones(M,K)*log(prob/K/(1-prob));</span></span></div></div></div><div  class = 'S6'><span>Then we generate multinomial time series data </span><span texencoding="\{X^t\}_{t=0}^T" style="vertical-align:-8px"><img src="data:image/png;base64,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" width="46.5" height="23" /></span><span> with sample size </span><span texencoding="T=1000" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAAAkCAYAAACpH0VdAAAEzklEQVR4Xu2aWegXVRTHP38qM8KQcomsQMKIXGhRqbAHK7WMeqj0QcQlEwlaLFxS0jALUXF/6KUSi+ihFZLItIUkijTLpUIohUzUyjBtwbSS758zMkx3fv878x+685vfnJf/MvfcOed855x7lttGTS1jgbaW0bRWlBrsFvoIarBrsFvIAi2kau3ZNdgtZIH/qnoZ8F0GC5wNiKcb8Dlwsqy8aZ7dFVgOuRO4o8DsDEqXYeloYAFwGLjVQ6AzgCeB+4FvgG+Bm4HPgPnArgZ7BOFNA/sWYKMJuxf40IzwO3AHcI09ex34FOgFjAAG2QfyFnCnh8HKsERyC7TrTJgNHmDLbmuBicBY4BXjPRf4BOgNDAe+digYijfVcxcD04AxMdAjub8CrrQ/rga+jCl0I/AB8AiwpgxIdiDDo8AfwHHg+QxgrwYeBF4D7km8Y7A5wM/AEGBf4nko3lSwtwEPA5sTgvYBfrD/HQQuAv5NrNlpX7tCWzPRAeBCoCPPvhzYbYpdb8Am9XzXIt0yYEbsYSjedhFcYbwn8Izji9X6SRa+9PsLFsaSiiq039VMKJusOnOVaHUE9iLgMYsI3YETDl0fBxYCvwAXA3/amlC8qWCfBShBO+ZQ4iVgnP1fP192rFGId51VZcffB2wlVt9bRHsPUG7jIh1nH9mDe81BQvGeli9Lna21Ct1Kxv6xJETnUlXIB+wBgI4pkXKSh1KUP98SWj1WLjAFCMWbC+yrgC+McwswtCooZwjjo4B3bL3CtEosF50ZC++qakYCoXhzgT0TWGKcTwHzCgL7bitTOrudzskjndjEx7Mnx7J2JV5KwNLoN0ClmJK5K4BQvLnA1hcanVHDgI87Ydg46wpgegF7XRKrFPJs5wN2lHhp//uA5xq8aL+d7SrtBHoo3sxgn2OZpRI3eU8P4O88FnXwqHwZWMBeSh7V9MlLPmDPBZ62F6gyWdfgZXuAvtY+7QLMCcR7ujT2TdB05qgkEbkaCXkNXCY+H7CVWUferD6EGiRppLarEjV5uMqvULyZPXtprDkwFXi2TCgVJIsP2LcD6+19T1ib1fV6OZHqb5VbW62TFoo3M9jbre8txksdLcCC7B10Gx+w4xWJcg21W110HvCrPYjmBKF4M4Gtpr5aifpa1SzpXzAkzZSNywZqF6tNrE6hZHeRcpAd9kBzgpVmvxC8mcAeD7xoHI2+5rzfQDNl49JxlTVTfrLGUnI2oDUPWNNFSazOazWjQvK2v9wnQVPGOcGE1XgzOrPygpvka6ZsXLKr7IwGRIpyrtbwq+b1GoiomRJRKF4vsNUnVzap4YhIIf3HolAu2T7R1CsJkEvMaEbginTKaTQGVhftJptvx/cIxduhZ88CNNsWqR+us+pQyUAqQpxrAbWAFek06OgH/NVgY11Fet8uPMhbdWEhIpWourGiOfebjj1C8TrBVgNAbdEbrGSIy6tGwSZAGWbR4bwI0LLuocndbRZy1TiKSMOOt01X6esiRTvV3PLeN+xqkva7wMpUeXAaBeH1ObOzGrDV1msGruxbs21d4dI1Ld188aH/lbcG2weSiqypwa4IkD5q1GD7WKkia2qwKwKkjxo12D5WqsiaGuyKAOmjRg22j5UqsqYGuyJA+qhxCsW7jDQqmPkiAAAAAElFTkSuQmCC" width="61.5" height="18" /></span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>T=1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>X=data_gen_MN(M,K,T,A,nu,prob);</span></span></div></div></div><div  class = 'S6'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Cross validation:</span></div><div  class = 'S2'><span>Given data</span><span texencoding="\{X^t\}_{t=0}^T" style="vertical-align:-8px"><img src="data:image/png;base64,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" width="46.5" height="23" /></span><span>, we can run 5-fold cross validation using function </span><span style=' font-family: monospace;'>cv_MN.m</span><span>.</span><span style=' font-family: monospace;'> </span><span>First we need to specify a list of tuning parameters for us to choose from. We can let the largest one </span><span texencoding="\lambda_{\max}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAAoCAYAAAC1mQk2AAADoUlEQVRoQ+3Yd8i1cxgH8M9L9nqRFRFC2SEjIaMoIyOvEdmkyMreKxlRpIxsyR9GRikjZCRlb8lM2SPZs29dd91O5/E+h/O+zrl7fnXqOffzO7/7+l7f6/pe1/WbpqNrWkdxmQI2bsxOMdZlxpZDPs+MA8jJhuLuuB1z4EDcMOrgJgNsXnyIx7A5PsG6XQC2F37GXdge92Eu/D7K4CbD2CG4tkDMhx+wFD4bd2C99gdYROSrrgH7HtPxa5eAzYnvMP8og4ptk8mxNoadK9+W6BKwZfFSMbZiV4ClMD+MLfEK1u4KsFNwPr7Fa9i0C8A2xhP4E6cXa9uNO7BF8AKSU2fiPeyE9I4jvWamirchLdWL2BBHYK1qhMcW2P7VxacQB1TAJc8WwNEjjeof6tiqeA4L4pwKw2C5ouQ+YjLSq18ozo2nsT5exgat9ukmfIljC9W+uKWFcDF8gz+weE0BGXOalbKxEj6YoCVLNCxfo9HX/8Vz/YBdguPwGzbC860X3IF0+BlfIihHVVgGYHJxmwrbyyoXA/RmHICwvB9WwafYAm/V2RmDrsQ8eASH4XPsXdNEOp3j65Of5Lz76+w1cRaubzuiF9i2eKBCNPl0Wo/XrkHGmLC0CfaskE0PeTd2xNU4o5i9Cgfj3np5FDbgH6rW7NA6/yRcgKUL9Hp1bhx3ecuG/H1kqfI9eBRxatT6b6sNbMkKvcxar1Yo/tKzf1fcWc9i9OGt/1+IE7Aa3q7nqXdx1HlVA5vtX+DdYjfPwkwUd2v8WFcQGWTDYp43K9GS9AjDiZ7YeWO/kJ2Z3Pf7zWZYtEIhudSseDyebwNbo15+brHY7A1zC2PlPi/YCnlHwuu6Yry9LSEcpnJGdKDv+jfAJjprUGAp/hGSZgVQ2Mm0/mDleD9gsfn1cmDuYJ4cFmOzAlg6mQAKwx+3QrEfsGOqDEXgIkLr4Kdeo0aFsUwMCesYmdXcrUTpDmoZvTouLlWOKMUZF+HEWQksahiVy0gTQ7NyTZdciAGNAuZ5VCzXesvUvneqfCS33ixROhvPIoKV+5WQ8Dj2Qfbne0pDwjF591Qb3LAYSwmIITE0ahWxSAk4FbtVwU0HEwU7uaWQ8XTCbRdcioVKbPZAVHaHKg1p4VJf0xGlpLyB5GjKz4yqeWkabm3ADQvYRHk3yPPco6Rb+ah+lC5lBbxfI9MgZw185zHQ4f/n5lFibKh+mAI2VHfOhsOmGJsNTh7qK/4C2yzBKZ6c5WcAAAAASUVORK5CYII=" width="27" height="20" /></span><span> to be the smallest </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">Î»</span><span> leading to zero estimate for </span><span texencoding="A^{MN}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAmCAYAAACYsfiPAAAEZklEQVRoQ+3YZahtVRQF4O+JioWNLajoUxETAxU7sRMVxVbsxgDrh6iIYjfoExX8YYsdWJjYjYmFioFiN+Oxtmy35+x7nuf47sF355972XududaYMeZYe5wpzMZNYXiNAf6/Z3wsw/9xhhPgmWt7/IQfW/acAdOU97/ge9Sfdfr9tJi+2x6TO8NTY2echIVxBfbqAnhuvIw58SyOwX1YDUdjSzyG1Ru/j98jcSDuLmtfrNZMbsDVvndhI9yLDbsAvhlbMJFYl8MLtXWpkq8wFZbH8w0f8+JtLIAv6+8GBXi6EUqzvmdK7iksiXfK3ybm3bAjNsZbWKyxYH2cg6VwOfZtvN8U+2HzpuNBAN4A1yAl2Iuth62xCebCTI0fLYhbi88zcSEOaqzJ84cL6PiYH1/X1pyLV3DZoAGnJ1NOiXR67YseEOewD+EorInZS3nmp0lAyv00HIxtSlnf1vD7HNbA/jgDh+K82ppXS8t8MGjAIYYLitO1StRHwlwd9pJCYMuiIpUDSokfhs8xYwnItzWnqYBUVPabAx/ivVpr5P0dWLrTQfop6dnwZtk0vhPtgGizHOZqrF2yeCw2w+1YFDcUFl6mMPCDWKfhcJ/SPqeU51did6RVHsCeWLyw+j/O0g/g9MmqWKl4TaZThm0WcklWUrLJZvozfy9FwB1fquTkMrqOw+kNhwlKyvjJ8nxFPI0bsS2uK4GPv4EBDsOmDzMTk+VYopsot9lNSGaeKQwacgr4jJgQT0o5lvmaYK6AtEBl4Yzsl2r4rfY84LN2kRK4JRChMjDAd+IenI2PMB8+xTwtaKOYXi+H/aPM1oDJiIp6WqUoqVlL/4YA4y9rKwvJHYLtGvvsiqtK7/7Q4f1fy/9NSWecVDMwUYyaqcRDG1NnfKW/diq7p7RDTL8XAnq0PA8zp2yvxS4NYGH4zOUmV0QHhJGzf5RbFFxHm1TAydJLhRBuKR7PwhHl/2TgkS57haxew6m199+V/q1+n1dRXxEWmQAX1dZGsESobI/HO+yRXo/8TGt8PCjAh5feW7fmcI9aRDsxdYT8+ci6dxFCyliJpYd3QMowPZjZXFVAiCiZTLbGI9mNcspvErSKtKqjLITrERLrapOS4ZTLG4WY6tp15drmAZYeGy0LmaXkBwL44nJV27vhLdLwm6KSemHq0QrGxH17zXBUSxj1s8KkzUNnHMTXJ8hNZWitV8D3l9mZ4d7JwtoZK7Gw79+uZMOEvhfAWxW2TH/ki0MnqxRT3rUx9ahjHwlw5ltuHpFybTo5RBWpGcs9NFJxKG0kwCeUQZ7s/tqCIF8vcq2L9aKpRy0YbYCjR/MtKffM3GraLLeTyMbYE0UHjxqoto27AZ6lXAYiBvJdqXkBb/qMeMgtJZZKyCeZ3FGHzjoBjppJP+brX+x95LKQPv25gSDMnLkc/ZsvF5VF107AicOGeKQeHrbz9n2eMcB9h3DIHYxleMgT1PfxxjLcdwiH3MFYhoc8QX0f70+g6tYn2WtWzAAAAABJRU5ErkJggg==" width="30" height="19" /></span><span>, and then set the smallest one </span><span texencoding="\lambda_{\min}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAoCAYAAABTsMJyAAADTUlEQVRoQ+3YaaimYxgH8N/MMBk0BiHxhcF8sCQmS0JCZAuTkGTJjJTJVvZ9SUp84IMl2QofLGVkahBFUrLzgWT/YF8S2emv69HjnXfOnHnPOfU+p/eqU6f7eZ77vv7X/7r+13W/M0wjmzGNsBiBGVY2R8xMB2a2RP5e6jqYY/AQZuJU3D2MgMZTM+vgEzyHffA5du4qmOPxKx7FoViGtfHnsAEaDzOLcWc5Pgc/YzN82UUwvT4HTITg2+kA5ifMw+9dBzMLP2LdYQMSf8ZTM22/j6z62aTrYLbAG8XMVl0Gk2b5NPbDW9ipy2AuxnX4Ae9gr66C2QPP429cVuwc3EUwG+A1pEauwIc4ApnVJtuy/8t4ctCNV6dmDyDjzOvYDWdixxo2Bz2z33eb1sz3LPYfdOOxwJxc03GaY4AEUOpmPZw96IFjfJc6/BifDbr3qsBsh1ewPq6uFMsZt5Q0RxCGzvqBmY0XsSvexMLW6HIvvsG5heRE3N9CtRG+x1/YuKbrXBkai8RvXQz0G4c2xHc9UUqD/qrWNsdv5cNKwewH5kachz+wO15tffUwMjnnKhBROKtSLqBSWwdUSt5ctRVw9+EUhM2TsC2+wL54F3NxHE5AwDQ97HQcWz4swIP1/1p1brLkf9YL5iAsrzEn9XFpz/t3IFeCsLFnOZF0zMz2GA7H7bi8oncbTsPjuLKUMYCfqrFoSQGYjxfwPnaoM5MhWdul0vuqCmS+zYVxm7HARFGSVrmrvF1pFkrbdjQeqYU4ekbr4Q04H4nie7WefpTgXFs9qnn9a3xQLDZrAfJLC0zWw0ZYSzbkWazJnGTGR23nVifNK+Ul9q5oPlG10bxzPS7sAbN9BeaaYqt5N70r6RVGGkvKpY4aZrLetIYwkdtuLCUQQFG/1PZ/NgiYfgCztqZg0pAjBiMwI2ZWlVN91qNiUadIa64JsfwklfrIDyJ51lhmvNRB+kZjn1bNtFNvBQ6sa3om9thNOAeHlLhMes1EriOdcS69KAUfub4Ei2ruyiRxDy5qKdsFeAaHlXTHsUzmd+EoRCEzhaRZZz2N/Fbkopg5bmldSf4FNJkCsAYkTs2rIzBTE9eJ7zpiZuIxnJodRsxMTVwnvus/U9+5KZBOxowAAAAASUVORK5CYII=" width="25.5" height="20" /></span><span> to be </span><span texencoding="0.001\times \lambda_{\max}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="77" height="20" /></span><span>. We then choose the list of tuning parameters to be equally spaced between </span><span texencoding="\lambda_{\min}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAoCAYAAABTsMJyAAADTUlEQVRoQ+3YaaimYxgH8N/MMBk0BiHxhcF8sCQmS0JCZAuTkGTJjJTJVvZ9SUp84IMl2QofLGVkahBFUrLzgWT/YF8S2emv69HjnXfOnHnPOfU+p/eqU6f7eZ77vv7X/7r+13W/M0wjmzGNsBiBGVY2R8xMB2a2RP5e6jqYY/AQZuJU3D2MgMZTM+vgEzyHffA5du4qmOPxKx7FoViGtfHnsAEaDzOLcWc5Pgc/YzN82UUwvT4HTITg2+kA5ifMw+9dBzMLP2LdYQMSf8ZTM22/j6z62aTrYLbAG8XMVl0Gk2b5NPbDW9ipy2AuxnX4Ae9gr66C2QPP429cVuwc3EUwG+A1pEauwIc4ApnVJtuy/8t4ctCNV6dmDyDjzOvYDWdixxo2Bz2z33eb1sz3LPYfdOOxwJxc03GaY4AEUOpmPZw96IFjfJc6/BifDbr3qsBsh1ewPq6uFMsZt5Q0RxCGzvqBmY0XsSvexMLW6HIvvsG5heRE3N9CtRG+x1/YuKbrXBkai8RvXQz0G4c2xHc9UUqD/qrWNsdv5cNKwewH5kachz+wO15tffUwMjnnKhBROKtSLqBSWwdUSt5ctRVw9+EUhM2TsC2+wL54F3NxHE5AwDQ97HQcWz4swIP1/1p1brLkf9YL5iAsrzEn9XFpz/t3IFeCsLFnOZF0zMz2GA7H7bi8oncbTsPjuLKUMYCfqrFoSQGYjxfwPnaoM5MhWdul0vuqCmS+zYVxm7HARFGSVrmrvF1pFkrbdjQeqYU4ekbr4Q04H4nie7WefpTgXFs9qnn9a3xQLDZrAfJLC0zWw0ZYSzbkWazJnGTGR23nVifNK+Ul9q5oPlG10bxzPS7sAbN9BeaaYqt5N70r6RVGGkvKpY4aZrLetIYwkdtuLCUQQFG/1PZ/NgiYfgCztqZg0pAjBiMwI2ZWlVN91qNiUadIa64JsfwklfrIDyJ51lhmvNRB+kZjn1bNtFNvBQ6sa3om9thNOAeHlLhMes1EriOdcS69KAUfub4Ei2ruyiRxDy5qKdsFeAaHlXTHsUzmd+EoRCEzhaRZZz2N/Fbkopg5bmldSf4FNJkCsAYkTs2rIzBTE9eJ7zpiZuIxnJodRsxMTVwnvus/U9+5KZBOxowAAAAASUVORK5CYII=" width="25.5" height="20" /></span><span> and </span><span texencoding="\lambda_{\max}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAAoCAYAAAC1mQk2AAADoUlEQVRoQ+3Yd8i1cxgH8M9L9nqRFRFC2SEjIaMoIyOvEdmkyMreKxlRpIxsyR9GRikjZCRlb8lM2SPZs29dd91O5/E+h/O+zrl7fnXqOffzO7/7+l7f6/pe1/WbpqNrWkdxmQI2bsxOMdZlxpZDPs+MA8jJhuLuuB1z4EDcMOrgJgNsXnyIx7A5PsG6XQC2F37GXdge92Eu/D7K4CbD2CG4tkDMhx+wFD4bd2C99gdYROSrrgH7HtPxa5eAzYnvMP8og4ptk8mxNoadK9+W6BKwZfFSMbZiV4ClMD+MLfEK1u4KsFNwPr7Fa9i0C8A2xhP4E6cXa9uNO7BF8AKSU2fiPeyE9I4jvWamirchLdWL2BBHYK1qhMcW2P7VxacQB1TAJc8WwNEjjeof6tiqeA4L4pwKw2C5ouQ+YjLSq18ozo2nsT5exgat9ukmfIljC9W+uKWFcDF8gz+weE0BGXOalbKxEj6YoCVLNCxfo9HX/8Vz/YBdguPwGzbC860X3IF0+BlfIihHVVgGYHJxmwrbyyoXA/RmHICwvB9WwafYAm/V2RmDrsQ8eASH4XPsXdNEOp3j65Of5Lz76+w1cRaubzuiF9i2eKBCNPl0Wo/XrkHGmLC0CfaskE0PeTd2xNU4o5i9Cgfj3np5FDbgH6rW7NA6/yRcgKUL9Hp1bhx3ecuG/H1kqfI9eBRxatT6b6sNbMkKvcxar1Yo/tKzf1fcWc9i9OGt/1+IE7Aa3q7nqXdx1HlVA5vtX+DdYjfPwkwUd2v8WFcQGWTDYp43K9GS9AjDiZ7YeWO/kJ2Z3Pf7zWZYtEIhudSseDyebwNbo15+brHY7A1zC2PlPi/YCnlHwuu6Yry9LSEcpnJGdKDv+jfAJjprUGAp/hGSZgVQ2Mm0/mDleD9gsfn1cmDuYJ4cFmOzAlg6mQAKwx+3QrEfsGOqDEXgIkLr4Kdeo0aFsUwMCesYmdXcrUTpDmoZvTouLlWOKMUZF+HEWQksahiVy0gTQ7NyTZdciAGNAuZ5VCzXesvUvneqfCS33ixROhvPIoKV+5WQ8Dj2Qfbne0pDwjF591Qb3LAYSwmIITE0ahWxSAk4FbtVwU0HEwU7uaWQ8XTCbRdcioVKbPZAVHaHKg1p4VJf0xGlpLyB5GjKz4yqeWkabm3ADQvYRHk3yPPco6Rb+ah+lC5lBbxfI9MgZw185zHQ4f/n5lFibKh+mAI2VHfOhsOmGJsNTh7qK/4C2yzBKZ6c5WcAAAAASUVORK5CYII=" width="27" height="20" /></span><span> under the log-scale.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>init_nu=zeros(M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>init_A=zeros(M,K,M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>eta=2;tol=0.0001;iter=500;</span></span></div></div></div><div  class = 'S6'><span>Choose </span><span texencoding="\lambda_{\max}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAAoCAYAAAC1mQk2AAADoUlEQVRoQ+3Yd8i1cxgH8M9L9nqRFRFC2SEjIaMoIyOvEdmkyMreKxlRpIxsyR9GRikjZCRlb8lM2SPZs29dd91O5/E+h/O+zrl7fnXqOffzO7/7+l7f6/pe1/WbpqNrWkdxmQI2bsxOMdZlxpZDPs+MA8jJhuLuuB1z4EDcMOrgJgNsXnyIx7A5PsG6XQC2F37GXdge92Eu/D7K4CbD2CG4tkDMhx+wFD4bd2C99gdYROSrrgH7HtPxa5eAzYnvMP8og4ptk8mxNoadK9+W6BKwZfFSMbZiV4ClMD+MLfEK1u4KsFNwPr7Fa9i0C8A2xhP4E6cXa9uNO7BF8AKSU2fiPeyE9I4jvWamirchLdWL2BBHYK1qhMcW2P7VxacQB1TAJc8WwNEjjeof6tiqeA4L4pwKw2C5ouQ+YjLSq18ozo2nsT5exgat9ukmfIljC9W+uKWFcDF8gz+weE0BGXOalbKxEj6YoCVLNCxfo9HX/8Vz/YBdguPwGzbC860X3IF0+BlfIihHVVgGYHJxmwrbyyoXA/RmHICwvB9WwafYAm/V2RmDrsQ8eASH4XPsXdNEOp3j65Of5Lz76+w1cRaubzuiF9i2eKBCNPl0Wo/XrkHGmLC0CfaskE0PeTd2xNU4o5i9Cgfj3np5FDbgH6rW7NA6/yRcgKUL9Hp1bhx3ecuG/H1kqfI9eBRxatT6b6sNbMkKvcxar1Yo/tKzf1fcWc9i9OGt/1+IE7Aa3q7nqXdx1HlVA5vtX+DdYjfPwkwUd2v8WFcQGWTDYp43K9GS9AjDiZ7YeWO/kJ2Z3Pf7zWZYtEIhudSseDyebwNbo15+brHY7A1zC2PlPi/YCnlHwuu6Yry9LSEcpnJGdKDv+jfAJjprUGAp/hGSZgVQ2Mm0/mDleD9gsfn1cmDuYJ4cFmOzAlg6mQAKwx+3QrEfsGOqDEXgIkLr4Kdeo0aFsUwMCesYmdXcrUTpDmoZvTouLlWOKMUZF+HEWQksahiVy0gTQ7NyTZdciAGNAuZ5VCzXesvUvneqfCS33ixROhvPIoKV+5WQ8Dj2Qfbne0pDwjF591Qb3LAYSwmIITE0ahWxSAk4FbtVwU0HEwU7uaWQ8XTCbRdcioVKbPZAVHaHKg1p4VJf0xGlpLyB5GjKz4yqeWkabm3ADQvYRHk3yPPco6Rb+ah+lC5lBbxfI9MgZw185zHQ4f/n5lFibKh+mAI2VHfOhsOmGJsNTh7qK/4C2yzBKZ6c5WcAAAAASUVORK5CYII=" width="27" height="20" /></span><span>:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>lambda_max=0.01;stop=false;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">while </span><span>~stop</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    lambda=lambda_max*K*sqrt(log(M)/T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    [Ah,~,~,~,~,~]=fit_MN(X,lambda,true,init_A, init_nu, eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">if </span><span>sum(Ah(:).^2)&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        lambda_max=lambda_max*2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        stop=true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S6'><span>Choose </span><span texencoding="\lambda_{\min}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAoCAYAAABTsMJyAAADTUlEQVRoQ+3YaaimYxgH8N/MMBk0BiHxhcF8sCQmS0JCZAuTkGTJjJTJVvZ9SUp84IMl2QofLGVkahBFUrLzgWT/YF8S2emv69HjnXfOnHnPOfU+p/eqU6f7eZ77vv7X/7r+13W/M0wjmzGNsBiBGVY2R8xMB2a2RP5e6jqYY/AQZuJU3D2MgMZTM+vgEzyHffA5du4qmOPxKx7FoViGtfHnsAEaDzOLcWc5Pgc/YzN82UUwvT4HTITg2+kA5ifMw+9dBzMLP2LdYQMSf8ZTM22/j6z62aTrYLbAG8XMVl0Gk2b5NPbDW9ipy2AuxnX4Ae9gr66C2QPP429cVuwc3EUwG+A1pEauwIc4ApnVJtuy/8t4ctCNV6dmDyDjzOvYDWdixxo2Bz2z33eb1sz3LPYfdOOxwJxc03GaY4AEUOpmPZw96IFjfJc6/BifDbr3qsBsh1ewPq6uFMsZt5Q0RxCGzvqBmY0XsSvexMLW6HIvvsG5heRE3N9CtRG+x1/YuKbrXBkai8RvXQz0G4c2xHc9UUqD/qrWNsdv5cNKwewH5kachz+wO15tffUwMjnnKhBROKtSLqBSWwdUSt5ctRVw9+EUhM2TsC2+wL54F3NxHE5AwDQ97HQcWz4swIP1/1p1brLkf9YL5iAsrzEn9XFpz/t3IFeCsLFnOZF0zMz2GA7H7bi8oncbTsPjuLKUMYCfqrFoSQGYjxfwPnaoM5MhWdul0vuqCmS+zYVxm7HARFGSVrmrvF1pFkrbdjQeqYU4ekbr4Q04H4nie7WefpTgXFs9qnn9a3xQLDZrAfJLC0zWw0ZYSzbkWazJnGTGR23nVifNK+Ul9q5oPlG10bxzPS7sAbN9BeaaYqt5N70r6RVGGkvKpY4aZrLetIYwkdtuLCUQQFG/1PZ/NgiYfgCztqZg0pAjBiMwI2ZWlVN91qNiUadIa64JsfwklfrIDyJ51lhmvNRB+kZjn1bNtFNvBQ6sa3om9thNOAeHlLhMes1EriOdcS69KAUfub4Ei2ruyiRxDy5qKdsFeAaHlXTHsUzmd+EoRCEzhaRZZz2N/Fbkopg5bmldSf4FNJkCsAYkTs2rIzBTE9eJ7zpiZuIxnJodRsxMTVwnvus/U9+5KZBOxowAAAAASUVORK5CYII=" width="25.5" height="20" /></span><span>:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>lambda_min=lambda_max*0.001;</span></span></div></div></div><div  class = 'S6'><span>Generate evenly spaced 20 tuning parameters under the log-scale:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>lambda_c_list=exp(linspace(log(lambda_min),log(lambda_max),20));</span></span></div></div></div><div  class = 'S6'><span>Given the list of tuning parameters, we run 5-fold cross validation:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>pred_err=zeros(1,length(lambda_c_list));pred_loss=zeros(1,length(lambda_c_list));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:length(lambda_c_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    output=cv_MN(X,lambda_c_list(i),true,init_A,init_nu,eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    pred_loss(i)=mean(cell2mat(output.pred_loss));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    pred_err(i)=mean(cell2mat(output.pred_err));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span><span>  </span></span></div></div></div><div  class = 'S6'><span style=' font-family: monospace;'>pred_loss</span><span> and </span><span style=' font-family: monospace;'>pred_err </span><span>contain the average log-likelihood loss and prediction errors evaluated at the test sets in 5-fold cross validation, and either one can be used as the criterion for choosing lambda.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>[~,I]=min(pred_loss);</span></span></div></div></div><div  class = 'S6'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Estimate the parameters:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>lambda=lambda_c_list(I)*K*sqrt(log(M)/T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>[Ah,nu_h,~,~,~,~]=fit_MN(X,lambda,true,init_A, init_nu, eta,tol,iter);</span></span></div></div></div><div  class = 'S6'><span>Estimation error:</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre;"><span>sqrt(sum((Ah(:)-A(:)).^2))</span></span></div><div  class = 'S9'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>ans = 2.1755</div></div></div><div class="inlineWrapper outputs"><div  class = 'S10'><span style="white-space: pre;"><span>sqrt(sum((nu_h(:)-nu(:)).^2))</span></span></div><div  class = 'S9'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>ans = 1.0627</div></div></div></div><h2  class = 'S1'><span>Logistic-normal method</span></h2><div  class = 'S2'><span>Assume that the time series data </span><span texencoding="\{X^t\in R^{M\times K}\}_{t=0}^T" style="vertical-align:-8px"><img src="data:image/png;base64,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" width="100" height="23" /></span><span> follow the logistic-normal autoregressive model with event probability varying over time, where the network parameters are</span><span texencoding="A^{LN}\in R^{M\times (K-1)\times M\times K}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="134" height="19" /></span><span>, </span><span texencoding="B^{Bern}\in R^{M\times 1\times M\times K}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="116.5" height="19" /></span><span> and offset parameters are </span><span texencoding="\nu^{LN}\in R^{M\times (K-1)}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="98" height="19" /></span><span>, </span><span texencoding="\eta^{Bern}\in R^{M\times 1}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="81" height="19" /></span><span>. We can estimate these parameters by applying the functions in the folder </span><span style=' font-weight: bold;'>logistic-normal-varying-q. </span><span>For simplicity of the codes, we will use only two parameters </span><span style=' font-family: monospace;'>A </span><span>and </span><span style=' font-family: monospace;'>nu</span><span>, where </span><span style=' font-family: monospace;'>A</span><span> is concatenated by </span><span texencoding="A^{LN}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAAmCAYAAABgUQN4AAADr0lEQVRoQ+3Yaah1YxQH8N8rIvNUpsxzIhTiAyKECL0ZPhoyD5kyhA+izPNYpkIpkSnzECKSeSYyT2XMPPevdXTu7ty7z7333Hteb3d9Omfv9azn+a/hv9azZ5mLZdZcjM0MuP9rdGciN8DIzYNFetj7CX82njd1v++xblFGlNYInemO3ILYB6djefyIs3ENvmgcfiHshzMQENvjoYbO3jgTy+BkXIa/OzrTDa6z7+3YHSfhrJbMOBfH4Y5a01S/Gt/hhOaLQYFbAL+OI30/wMpYrkfEmmaewNJYC6vi44bCczgYz08FuO1wU6VGP/hyyLfxMjZsWbA47kOic32l4Clda5bCS1gJ/wwa3LxlfL3y7td9oDsCl1StndiiPxsbV41+UqSzIv6odXtiB+zfy85k0/KwKuLY3gpJoTa5BztjGzzWohyiubn0zsHxRUi31Lq8T2RvGzS4JfAukhqRQ3BVy2HnR6KbFMq631v0k77rl95qtd9T2LLWvYeN8MOgwV2MzbFJGQ4NJ+XGkm3xMO7Gri26AZVo7dil14n6BpWacebWo9mZaFqui8exRXkz9h9FDj+WdFIr6XxFi25S8C9c0KUXoPdWhryJsHRs9pSJgkueP4gL8Wk15C+xbMuBw5Dx+up4v4fuKmXr6XLWkXitSy9TyzvFzC/i0Mb7ESYnAm4nXIQwZFjrgZoeYjj9aDTGTE/7DB8iIHrJrUhUY/cVhBmbcizOq36XFjCqjBfcfHi1poE7y+r5OKZ+p9CfHGW3A6tfxeOh925ZoXpYQKeGAjA1GZpvypJIW7gRBw0S3NHYpWi8Y3dfXFd/RmPMw2vUyjwZeR2f19CbRp1UjeOOwm/VA6OXGfTSrr7W2fNa3IWOg3tiHE/kknKh5pBGpoKObIpn608OkjqZaomTvsUvg4rcleXdAxoGF64+E0f1w5hTDfw/+/1GLj0ntfIVfu5xujTY2Mq1JcQxR0i/4B6pqTtXlV4S9tysXmTy+GZOQNcPuN2q4a4xStSC4/LqOfk9FmNOK+Y2cJkA3qgpYKy5MSSScSySu1WuKEOXNnCn1nUiUWt+4+g+fPrR/fWgnxlzWoCPBW4dvFB3r7Z719p4q078TA3U0wJgIq1gsaL1TBKZFDLFjyV7oXPHSoTXRD4lDFV6RS4TSOon3ysiH9WFMHXVvH+FIdP39kDGoo7kO8cNOG2Y6Npqbphnm/TeM+Am7cIhGZiJ3JAcP+ltZyI3aRcOycBM5Ibk+Elv+y+E2qwnn6E+4AAAAABJRU5ErkJggg==" width="27.5" height="19" /></span><span> and </span><span texencoding="B^{Bern}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAmCAYAAABwMU2kAAAE/0lEQVRoQ+2YB6gkRRRFzxowY1bMyq5izooBM+q6mBNGMEcUUVEMYBYRTCgquqsi5hwxIAYMYEJRVMw554xZznpbatr5f8a/f2f/QF8Yhqnurq667777Xs0oGkxkYFTDwz8MNERECQ0RDRGtptBLRcwITFvzpF+Bn0eCT/WSiNWAfYD9svE7gB+ANYDXgZOBJ6YUKb0kwj2uADwPfAwsBPwRlbwPzAysCLwxJcjoNRF7AJcDVwB7Fhu+BNgXOAS4YKQSsRWwCTBVmwX+BXwLfAi8A9wPmPcD4WpgF2An4PriphuB7YHdAO/pObpVhEZn1HYtVmhOvwzMBWwMSNgnwGkDRNV3fQrMCcwNfJW5VgEeA94G1gK+qbGwAbAksAjwO3B8ri8HbAYsCzwOjAeOA/SiA4D1gJWABUL+vMCpScmjgBfK93RLhM/sANyQh58DVq4t2AWekjFlr/xLuOFngDeBg4D5gTUBN3RLUubL4oHpgXOBmYC9gEWB14AlYq7TAJKkCjfPxpcHNgWWARYG7gEuy7oM0JPAecAZwDFDJeIE4MQ87KRVZKr5NLvv88PNjqkRcWzUcm2qw3zZoOToDaZWBQN0L7BUPj8CRvGIEKjJiq2Bm4DDYsIqa3TI1ngNmOm2ap6VTNdm5bp0qEQ8BKyfh9eJnOu5rNxnB/QOv/WPCo8A6wKrA09n0KgZZSWvQr7LuNK+CNguajElzwS2BJ4t5jwf2Ai4LuW3XI/EGbizoizVpj/pQYvXq1O3qWG03aQNkZvTF1x8Ccc+z4ARnKMwzlkAF2Lf4H1/Fg8+HFnvDlyV84/z/JKcNs/fje+UxDqFJM4DLA18VFvPA1HCjkkfL5smeoeqaUG3RGwB2ACJm+Pw9bl2Bq7J4N3J2+oejfS2AZ69L1XpYODCpIImbJk9sjDV+vsWA96KcvScEpq7gXs0Rl5ds1+5CzhwqERY212osN7r0CX0g6eSDr5MEzMXK7hBX+7n4mJ8tmzGb03zpZBsOT0UUPolZiha8ip97Ew1wRJjY5TbJABe028k2DFVaJn/qXqoW0XYAlfmZ0f4AaDcjYqObus8XXJVE1XKFRx/LxI2nx/MBSVt1Mcl8uaysBy+mGh6/2+Apc+oS6glWNyaymVZrePsGKKl2hQTFXGa9P4x7n/TuxsizKeq7dUEbZ4kYda8wLFzgNPjA+WijIKlSpMTEmTNV7rW91eT+/WInpSq9HUIMf81P71HWDr1nCtTcepEqCzn3ra4oAd5/+1RdeVnE2/phgjlbCSETPuxti8I6B2WLmE+2mtUEWsTqP81ZDQ1Vg1RsocDqvCzdhN1Q4Qmp9mJDQHLaIm9C88wCjY1g7XZw7GhYZ+jExGWSyVoKmgs9gb1TXoG+SLXXKB+MWHYVzqZJ+xEhA2QjZCw07O3bwfzrvIBq8J/ytNk3sckT9+JCFtpW2NhTa+cvf5izyD6g9A4D5/klfV4gk5EeA7wsCT8U6XlxFastSyvHqdtuvoKgxHhUdkK4D2WGmt5O/f26Oxhx/v0EXuLts48kpkZjIjq3yTXf2fhAeV+JMeO0sOTzYmnQdvrvsNAREydo7InRWFjszbwSjpIo+5hRt+wovinytGArXFfoh0ROr7trK1uHZ4eLammjGcKO0WNUsWUJ8q+I6OTWfbdhoa64IaIMNcQ0RDRmkSNIhpFNIpoW1ia1GhSo1UYfwNx6gQ2L1U7BgAAAABJRU5ErkJggg==" width="33" height="19" /></span><span> in the second dimension, </span><span style=' font-family: monospace;'>nu</span><span> is concatenated by </span><span texencoding="\nu^{LN}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAmCAYAAACCjRgBAAADXUlEQVRYR+3Xech1YxQF8N8n81ySqczTH5JZkciUMhTRh0QSMkXKlEhmEhkylFCKopAh/yhRUjJkypgpU2TMPLdq3zod5977fnTfc9+6+697z3nOc/baaz1r77PIAo9FCzx/MwB9MzhjoIOBpbBKx/Uf8Ufr+rJYoa79iR9a99t7/WvNJBhYEUfgYqxbSV2F2/F5K8ENcTLOwk9YD9821qyMY3EtPsAZeKy5xyQADPZ/AAfjPFw55qw8j+0rwes71r6N0/F4+94kAaRiG2Cdjso381gJz2FjfIQt8XdjwWp4p9hsS3BiNro53sLL2GZM9Q/A7lgTx2AfPNF4JiwehiO79pkUA6fhBkT7544BcBMexjfFxIM4pPHMzXgWd88ngEexP/bEk2MAvIYd8XMB2A453B/Xc9H/rvhyvgAsh69Kx2vgtxEANsMt2LvWREJ34RJcWOfiXuw8bI9JSGiv0vAjOGhM9SO12G6klli+Kv871sdxWBsXzSeAq8vXT0H0Oyri6RfgxcaigDkbh2NxWXBcqjPmwsCqiNV9NiaZwe04z9bYBO91PBN9p8El6TexUcs28//dOrhrYQv8tSQAYoGHYtuywCRyFO7p2CQFuLyaVW7H8z/Fh3UQu957P8LOTrVvKt2OyC/2Guc5elThuhgI6jhBpLBVVSfXulwg7pA1t9VLTqjfL9UezXdnTLisgO2BAAkLV3QkuF913Xh/DvHQGCWh+HgO2QvYYcgONyKtP5SfWkxEHonXS3Z5x+olq2VK3ynImYiFxnECphl55g3sgq//K4BXq7qRyPkdm2SKfKqkMMfjsUTLNq3CjHxoGAOhe9BI0uaf7tglHTbzS2TTWwwDkBH2DnyPNKP2EJVrmXVCcTplbzEMQA5O3OGhGonbCV5XDejE3jKvF3cByFfQF1X5k3BrK8lYatp//DmW2Wt0AchgNeh80fj7jQzjyXfiGpzTa+YjGIjjXFofEWlqgzi+2HgG++KXaQUQx9kNmdMzRKXpZDZJ50xPyLD23TQknxzaEsrck1F46XKg/E/kEy+NLbL5dVqS7wJwYH0dDXLMR8Z9NVUOnQj7BNRmIC0+jemT8vdXiok+cxz57rmM01ObfJeEpjrZruRmDPRN2YyBGQP/swILXkL/AHGjnSenj6fGAAAAAElFTkSuQmCC" width="24" height="19" /></span><span> and </span><span texencoding="\eta^{Bern}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAmCAYAAACYsfiPAAAEqElEQVRoQ+2ZaahWVRSGH0tDjBJMK4vKrDCn0MqgWX9FNNAgRShSURFl448GLcsGMSLURrRosEFFUKSsEErIJrGysmhOs7KyEpoLbeCRtS+bw/k++O69JzheF1y89wz77Hev9b7r3dtudLHo1sXwsh3wtp7x7RnuhAzvAOxSMs4vwD+dMH6Hhqgiw72As4GpwD7AN8Ai4FBgD+BJ4Hbgrw7NvJ0vVwE4TWUxcBpwCfBAXLwMuBuYDVzczjl36LUqAa8D9gMGAF/ELPcCvgZ+APp1aObtfLkqwAcBHwMfAoOzuQ0F3gM+BXzmf4+qAE8E7gFmAlcFKr81HzgrytmyzmM34AxA0TsGmAW8AewOjAWGA1sAaeEYFwDXhk6MBPzx3rfA9cAY4H5gYf6RqgA/DZwM3ASsAfYPMJ8BjwEvFsAK0AU4H1gZwuYj44AdQ/WlggDeAs4ETg/Qq4ElsRhDgPuA14HpwCfAkVUD3gnYFB+5Gtg1MnYscB3wEPBvNonjgBcAn7UqegcVpsXfPtoneH8N8DcwAxgIrIWtbvF7YC7wZ9zbCKwHVsSitX2uigxbSmbwWeCkDJhKrTLfCkyJ6zsD7wI/AaOAvsBTgIJ3Yda3zah0eDDKVtApjoiquDfefQ1I4ugYLnClgC0luSV35XCK0cBywLI+MC5eHly1Vf0G9Acejszk85wDTADOAWx3edwA3AJMijL2ns9KnX2BL1sBrGPSIRXDEvNeajf5fTk1IkRGRU4hl14FLDcNiLEgBOlw4J0mTsyMuyDDCnRwjJcAuXtAVIrXngAOK3SIrR9sVNJmw1V3IIVEfhjyy9LUSammy4ATMlB7AhsClL/nYRnrvlRNVdZwQXzOUs5Dt/Z7XDgY+CD4f0fhORddvVCorszuqdRSwGtWjW6vIeBTgfEBRMER+BWRFQGqiGboohhDy2hWDT+goCgWilEK2828KK+jge/ihuBtOScCz8c1FzO1MC/5balhBj8vAHauzkdBfLmwQPJ+76DAV40A2z7sZSqm7UFBEITEXwpMBl4BLMFVMcigMBk+J490UKrwc0EH+6sZs3wfBX7OJi2XFTdNiGJjdchhr6Xwdz25fbgYZtZqMQFpY6K7c2HeBi6NFtX2XrGke0Y/819LpUeAdhHkhRk27I/+bTvwY3mbKZlX00v2WQFbdqp1Z4QU+bFsXo04bDt5JkCrpA6g80mRWow8UTlrE40Ayxm5Yxv5NXY9+V5WLyynFLRHaoO2iUq/HwptK1DeP8pA6XDspYbcahOEOgAvy3ByKc7f5n1uAYhuyZIu7oTqgLe0DyeXIgCzq1nPw9MLjXtqV7UAmiZZluHHow/riuyZeXQPE68BOSWErfaAbQ+6H1uRhjyPo6IPb44djIJWqyhm2Obu7sXIj2YSqJtjj6t/Pb5WSGOyRcA6rLti035ICSDL3E3AjcBt2wLgZhiSUZfH+mT9cu2ilQOA5L48V3JT8Uft0DYxHmVYPKlws/1mbB7qiLel/z1MB3PueM6rJdoWM6wB8ShUpXYjX8tohcPuZ9173gl4eljLaAWwG3l/PONqOzKpG+pWANcNW+l8uxzg/wBOn/AnOHj2XgAAAABJRU5ErkJggg==" width="30" height="19" /></span><span>in the second dimension. When assuming the event probability for each node is a constant (</span><span texencoding="B^{Bern}=0" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAAmCAYAAAARKW/mAAAHF0lEQVR4Xu2aBYwkRRSGv8Pd3T24u0twdw/uEiwQJMEJwQkEtxDc3YMEC+4Q3N3dJd/l1VLbN30zy87NNnP9J5NNurqqq57+79UOokZXSmBQV56qPhS1YrvUCGrF1ortUgl06bE66bFjACMX5Pgb8HOXynZAj9VJxS4EbA/sGCe+CfgBWBR4HTgCeGRApdFFH++kYhXbPMCzwMfA1MCf4cXvA2MB8wJvdJF8B+wonVbs1sCFwEXANtmpzwF2APYATh8waVT3wyMA0wFTAM8B3zfbaiuKXRtYCXDxIv4GvgU+BN4B7gLMm2W4FNgM2AS4MnvpamADYAvAd2r8K4HNgcNhcGl6N7AiYIQ7Fbi+TFCtKNa5Eh+9yo8kmBNfBiaKj2kAnwBHl3id3/oUmBCYGPgqFloAeAh4G1gc+Kaw2eWAWYFpgT+AQ2J8LmBVYE7gYeA84GDAXL4zsAwwHzBlGNOkwFGRAvYHnv8fWM+2ca4zIprpSDrY2RHxdIQrGp2jVcU6d0PgqljkGWD+woIK/Mh4Zpg13OZQgU8CbwK7RlhZDFBB10WI/jKbMBpwCjAm4AENRa8BswTZGglQ6UaJNUKRcwMrA3MA0wC3AxfEvjS4x8LSjwUOrLhilbdK0zs1XolmwjjAiyHDtYDbimfpi2IPBQ6LBRRS8py0puQnxX6VN1PhYweFN18e7HfyUJjKNrcayhPc1x3AbPH7EdDL9o3DSLrEOsA1wF5ByvT8GcN4JGIaoFa9YMzVONybzPzcCitWr3wXmCoMUEMsIsnzqThfr/G+KPY+YNmYvVSEz+LHDK/jA4YM/5p/Ex4AlgYWBp6Ih3qVXmiIlRh8F88NpWcC64c3mwKOA7ROD5JwGrBCWLapIYeGoCGeGJ5vNDC/m8Nnrjj7Nupo2GKJkjJwSeDBeGcR4PH88K0qVm9UaTYYVJZ5VWXk8Nnn8UAPmyAjUmMDCtZw4nt/ZRPvjzC6JXBJkATX+TVyonlS65Ut54biEhrFJMDswEeF/dwTlrxRhGuHDcvmXr26yjAEbxzNm/FKCOkoIQ9T1sXAVv9FsWsCNhTEtcFgi4LZFLgsHt4aeS+9I7G6oWTuncG6dwMkCYZfSZll0X4ZySp+b3rgrfBsc3YOyZ6GqEXLIhPMV7cAu1RZq8AXQTJfAOQNZZAAylGUQy9jbdVj9RYFL6w3ZaA5zKeGAsOvwpPUmMsSVJjC9HdW9lxrdFP+dYMvhdFY/uwJGGpzjJ61IFO4tnMlKcqxShCndcOgHEsG4zOjhGXZTxVUsB6Y2qwapumrDI4bkj2L80yBg9GqYm35JTJkx+gDwPCq18hYbRWOGrlOUmXoTPD5exEyzYf3xoAhVK9cLTzTXChkgFqqm/b93wFLFb1SA7FkEtZwMnPLoCJOCoJkaWVIF8kQJG07BZErppNGAjTPa6j9hXIplnKN1kyRyDGji9GyDI6vHoOey3JzMFpRrC6e2nxahM0IlTpurOGzk4FjIo/mm9BLZHSSHqHCrTkNldaXr0buLHqcBbmC+DoUbP6UDJm7haWOOdvcIqMuQs937fWyAXO4798YUSfxgWYK82yy7v4iOUSzdXJSJOdw32VIDR/Hc1LakmINn3qK0BP8WVtKxbWmdGg9zNoreVSzAzQb19skWhKknhDTbFKTcaPEZ31cI9XafZw2xOsqIRnm0NaySaPxi2LrtThPMphas4bsxJJbUqykR/Ijlgcse3Jsl+VcvcRkP7S2Yn8F1O3zZ8j4iekmjzrFs0tk03ivEq5ZKLa8MeQZeiUakqOi0iymZXGOCfPt+d0u/WF4PqNh6jLpRDpTGeQrKf9bkvZEhGaK1b1tLAgLZnuzjWDeSnlU1lv1cmIY6qUtS0uy5DCNWrf5B56OfrgdP9uMPWimWFuHtq6ENWVirsXd20M2vwrJxj5tOV41Fuk0K/bUtl29ATNaemHSiGOoO/mCPETHsr3asmLt49q8F16Sl92I5OWQ12/G/m5Bp1mxcrPW9mJEWP7J8otIZaHPdSp75i0pVkuR4WoZlgbWko0sRxZn8933zMPWYX1lnlU2gk6zYmVhI0YZmjdTR64oo92jgWObdTLgl1YVm/7bwfdvznJoPl9l23GymW+xbziwnVij/xLwBsp7V6Om3bV0o+XK1vHW/jZo9o5Ljl5fLMuxI8aNgkWvsFHgLcMr0WHSK22um3dlzF6SHwDYCqzRPgmcENeNytbbrYR0ZWdPwavMIdBIsTJa23fG8CKk4ZZAhmh7wnaSJE56dH5j076jDd8rWUoeHy3QRwEvTOyD68Fea9qNa9i8acaKh2+xVuf0Ml9JrG1Y26uGZ3sHpagVWx3ltXUntWLbKs7qLFYrtjq6aOtOasW2VZzVWaxWbHV00dad1Iptqzirs1it2Orooq07qRXbVnFWZ7F/AFsPbTa4hFVHAAAAAElFTkSuQmCC" width="59" height="19" /></span><span>), the functions in folder </span><span style=' font-weight: bold;'>logistic-normal-constant-q </span><span>can be used, while for presentation simplicity we will omit this special case.</span></div><div  class = 'S2'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Generate data:</span></div><div  class = 'S2'><span>Consider the same setting as the multinomial example above, and the standard deviation for the Gaussian noise in logistic-normal model is set as </span><span texencoding="\sigma=1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAAkCAYAAADB7MdlAAACaElEQVRoQ+3ZS6hNURzH8c9VJAyQAfJIEUp5J2RgoEQZyEAppWSgPDPwKM/ERISJTORRmEqUgYlHShSRSCnKQCJliv6swe2cc+/Z696D071rjU57/dba//3dv7XX/79Oh9IqE+iorCxCBVaGCQqsAiuDQIa0OKvAyiDAYIzCh2aj+rOzBmEj9uIsjhdY9QQGYgP2YULq3lNg1YMaiS14hUXYWmA1W09/+qcmaPG7OKsJs3F4X5xVzVkFVjVOv1V/DdYYrMGSdJPh1NWVb7AqI9j/LW05rMjDduEoYsvtrp3HpooEdifoFeUNZZ9wqBcTtBTWaFzEshTQW1zHerzA1ZpAH+FlxeCfYlZFbVeyiGdyL+ZoGayheI5JKZjT2IEfmIu7WIcbPQx2dSoxejj897BvDV5Yznwtg3UK29Kdw+oHa6K4g6UJ2LWcCNtI2xJYC3EPA/AE85OjOj/nMcR3J97uiAb9bcSky1BaAutycsxPLMbDBreLD/m5dH18lYq9Dem1BNZrTMEzzOziIU9iOz5ibA9A9IndMJbU55RDXUjVeSMWsTxn41LaHXN59YndcCLepSePivxMAworcBNfMQ+xhee2PrEbRhIaH+1h2I8jNRTi+n3MwErczqXURvrOpw5xABibVret0UnpgZQqxFKZ02l05F63EO7bnNzVbP527t+JEynASH/WNgu2Eaw4bg1HRRIaWfkVTE/gHuAwvjebuI37wwwLsLymvo1V8jhVLVHn1rXuzuCjWJ6GIQiXfWljAP8ktP78h0U24AIrA1mBVWBlEMiQFmcVWBkEMqTFWQVWBoEM6S+F3XIl+n+0ugAAAABJRU5ErkJggg==" width="37.5" height="18" /></span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>addpath(</span><span style="color: rgb(170, 4, 249);">'logistic-normal-varying-q'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>M=10;K=2;rho=1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>rng(2578);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>A=zeros(M,K,M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:M</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    connect=randsample(M,rho);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>k=1:size(connect)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>     A(i,:,connect(k),:)=(rand(K,K)-0.5)*4;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>prob=0.8;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>nu=zeros(M,K);nu(:,K)=ones(M,1)*log(prob/(1-prob));sigma=1;</span></span></div></div></div><div  class = 'S6'><span>Then we generate logistic-normal time series data </span><span texencoding="\{X^t\}_{t=0}^T" style="vertical-align:-8px"><img src="data:image/png;base64,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" width="46.5" height="23" /></span><span> with sample size </span><span texencoding="T=1000" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAAAkCAYAAACpH0VdAAAEzklEQVR4Xu2aWegXVRTHP38qM8KQcomsQMKIXGhRqbAHK7WMeqj0QcQlEwlaLFxS0jALUXF/6KUSi+ihFZLItIUkijTLpUIohUzUyjBtwbSS758zMkx3fv878x+685vfnJf/MvfcOed855x7lttGTS1jgbaW0bRWlBrsFvoIarBrsFvIAi2kau3ZNdgtZIH/qnoZ8F0GC5wNiKcb8Dlwsqy8aZ7dFVgOuRO4o8DsDEqXYeloYAFwGLjVQ6AzgCeB+4FvgG+Bm4HPgPnArgZ7BOFNA/sWYKMJuxf40IzwO3AHcI09ex34FOgFjAAG2QfyFnCnh8HKsERyC7TrTJgNHmDLbmuBicBY4BXjPRf4BOgNDAe+digYijfVcxcD04AxMdAjub8CrrQ/rga+jCl0I/AB8AiwpgxIdiDDo8AfwHHg+QxgrwYeBF4D7km8Y7A5wM/AEGBf4nko3lSwtwEPA5sTgvYBfrD/HQQuAv5NrNlpX7tCWzPRAeBCoCPPvhzYbYpdb8Am9XzXIt0yYEbsYSjedhFcYbwn8Izji9X6SRa+9PsLFsaSiiq039VMKJusOnOVaHUE9iLgMYsI3YETDl0fBxYCvwAXA3/amlC8qWCfBShBO+ZQ4iVgnP1fP192rFGId51VZcffB2wlVt9bRHsPUG7jIh1nH9mDe81BQvGeli9Lna21Ct1Kxv6xJETnUlXIB+wBgI4pkXKSh1KUP98SWj1WLjAFCMWbC+yrgC+McwswtCooZwjjo4B3bL3CtEosF50ZC++qakYCoXhzgT0TWGKcTwHzCgL7bitTOrudzskjndjEx7Mnx7J2JV5KwNLoN0ClmJK5K4BQvLnA1hcanVHDgI87Ydg46wpgegF7XRKrFPJs5wN2lHhp//uA5xq8aL+d7SrtBHoo3sxgn2OZpRI3eU8P4O88FnXwqHwZWMBeSh7V9MlLPmDPBZ62F6gyWdfgZXuAvtY+7QLMCcR7ujT2TdB05qgkEbkaCXkNXCY+H7CVWUferD6EGiRppLarEjV5uMqvULyZPXtprDkwFXi2TCgVJIsP2LcD6+19T1ib1fV6OZHqb5VbW62TFoo3M9jbre8txksdLcCC7B10Gx+w4xWJcg21W110HvCrPYjmBKF4M4Gtpr5aifpa1SzpXzAkzZSNywZqF6tNrE6hZHeRcpAd9kBzgpVmvxC8mcAeD7xoHI2+5rzfQDNl49JxlTVTfrLGUnI2oDUPWNNFSazOazWjQvK2v9wnQVPGOcGE1XgzOrPygpvka6ZsXLKr7IwGRIpyrtbwq+b1GoiomRJRKF4vsNUnVzap4YhIIf3HolAu2T7R1CsJkEvMaEbginTKaTQGVhftJptvx/cIxduhZ88CNNsWqR+us+pQyUAqQpxrAbWAFek06OgH/NVgY11Fet8uPMhbdWEhIpWourGiOfebjj1C8TrBVgNAbdEbrGSIy6tGwSZAGWbR4bwI0LLuocndbRZy1TiKSMOOt01X6esiRTvV3PLeN+xqkva7wMpUeXAaBeH1ObOzGrDV1msGruxbs21d4dI1Ld188aH/lbcG2weSiqypwa4IkD5q1GD7WKkia2qwKwKkjxo12D5WqsiaGuyKAOmjRg22j5UqsqYGuyJA+qhxCsW7jDQqmPkiAAAAAElFTkSuQmCC" width="61.5" height="18" /></span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>T=1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>X=data_gen_LN_Bern(M,K,T,A,nu,prob,sigma);</span></span></div></div></div><div  class = 'S6'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Cross validation:</span></div><div  class = 'S2'><span>Specify the list of tuning parameters to choose from, including a list of </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">Î±</span><span> and a list of </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">Î»</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>init_nu=zeros(M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>init_A=zeros(M,K,M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>eta=2;tol=0.0001;iter=500;</span></span></div></div></div><div  class = 'S6'><span>Choose </span><span texencoding="\lambda_{\max}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAAoCAYAAAC1mQk2AAADoUlEQVRoQ+3Yd8i1cxgH8M9L9nqRFRFC2SEjIaMoIyOvEdmkyMreKxlRpIxsyR9GRikjZCRlb8lM2SPZs29dd91O5/E+h/O+zrl7fnXqOffzO7/7+l7f6/pe1/WbpqNrWkdxmQI2bsxOMdZlxpZDPs+MA8jJhuLuuB1z4EDcMOrgJgNsXnyIx7A5PsG6XQC2F37GXdge92Eu/D7K4CbD2CG4tkDMhx+wFD4bd2C99gdYROSrrgH7HtPxa5eAzYnvMP8og4ptk8mxNoadK9+W6BKwZfFSMbZiV4ClMD+MLfEK1u4KsFNwPr7Fa9i0C8A2xhP4E6cXa9uNO7BF8AKSU2fiPeyE9I4jvWamirchLdWL2BBHYK1qhMcW2P7VxacQB1TAJc8WwNEjjeof6tiqeA4L4pwKw2C5ouQ+YjLSq18ozo2nsT5exgat9ukmfIljC9W+uKWFcDF8gz+weE0BGXOalbKxEj6YoCVLNCxfo9HX/8Vz/YBdguPwGzbC860X3IF0+BlfIihHVVgGYHJxmwrbyyoXA/RmHICwvB9WwafYAm/V2RmDrsQ8eASH4XPsXdNEOp3j65Of5Lz76+w1cRaubzuiF9i2eKBCNPl0Wo/XrkHGmLC0CfaskE0PeTd2xNU4o5i9Cgfj3np5FDbgH6rW7NA6/yRcgKUL9Hp1bhx3ecuG/H1kqfI9eBRxatT6b6sNbMkKvcxar1Yo/tKzf1fcWc9i9OGt/1+IE7Aa3q7nqXdx1HlVA5vtX+DdYjfPwkwUd2v8WFcQGWTDYp43K9GS9AjDiZ7YeWO/kJ2Z3Pf7zWZYtEIhudSseDyebwNbo15+brHY7A1zC2PlPi/YCnlHwuu6Yry9LSEcpnJGdKDv+jfAJjprUGAp/hGSZgVQ2Mm0/mDleD9gsfn1cmDuYJ4cFmOzAlg6mQAKwx+3QrEfsGOqDEXgIkLr4Kdeo0aFsUwMCesYmdXcrUTpDmoZvTouLlWOKMUZF+HEWQksahiVy0gTQ7NyTZdciAGNAuZ5VCzXesvUvneqfCS33ixROhvPIoKV+5WQ8Dj2Qfbne0pDwjF591Qb3LAYSwmIITE0ahWxSAk4FbtVwU0HEwU7uaWQ8XTCbRdcioVKbPZAVHaHKg1p4VJf0xGlpLyB5GjKz4yqeWkabm3ADQvYRHk3yPPco6Rb+ah+lC5lBbxfI9MgZw185zHQ4f/n5lFibKh+mAI2VHfOhsOmGJsNTh7qK/4C2yzBKZ6c5WcAAAAASUVORK5CYII=" width="27" height="20" /></span><span>:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>lambda_max=0.01;stop=false;alpha_list=[0.3 0.5 0.7];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:length(alpha_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">while </span><span>~stop</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        lambda=lambda_max*K*sqrt(log(M)/T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        [Ah,nu_h,~,~,~,~]=fit_LN_Bern(X,lambda,alpha_list(i),true,init_A, init_nu, eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">if </span><span>sum(Ah(:).^2)&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            lambda_max=lambda_max*2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            init_A=Ah;init_nu=nu_h;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            stop=true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S6'><span>Choose </span><span texencoding="\lambda_{\min}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAoCAYAAABTsMJyAAADTUlEQVRoQ+3YaaimYxgH8N/MMBk0BiHxhcF8sCQmS0JCZAuTkGTJjJTJVvZ9SUp84IMl2QofLGVkahBFUrLzgWT/YF8S2emv69HjnXfOnHnPOfU+p/eqU6f7eZ77vv7X/7r+13W/M0wjmzGNsBiBGVY2R8xMB2a2RP5e6jqYY/AQZuJU3D2MgMZTM+vgEzyHffA5du4qmOPxKx7FoViGtfHnsAEaDzOLcWc5Pgc/YzN82UUwvT4HTITg2+kA5ifMw+9dBzMLP2LdYQMSf8ZTM22/j6z62aTrYLbAG8XMVl0Gk2b5NPbDW9ipy2AuxnX4Ae9gr66C2QPP429cVuwc3EUwG+A1pEauwIc4ApnVJtuy/8t4ctCNV6dmDyDjzOvYDWdixxo2Bz2z33eb1sz3LPYfdOOxwJxc03GaY4AEUOpmPZw96IFjfJc6/BifDbr3qsBsh1ewPq6uFMsZt5Q0RxCGzvqBmY0XsSvexMLW6HIvvsG5heRE3N9CtRG+x1/YuKbrXBkai8RvXQz0G4c2xHc9UUqD/qrWNsdv5cNKwewH5kachz+wO15tffUwMjnnKhBROKtSLqBSWwdUSt5ctRVw9+EUhM2TsC2+wL54F3NxHE5AwDQ97HQcWz4swIP1/1p1brLkf9YL5iAsrzEn9XFpz/t3IFeCsLFnOZF0zMz2GA7H7bi8oncbTsPjuLKUMYCfqrFoSQGYjxfwPnaoM5MhWdul0vuqCmS+zYVxm7HARFGSVrmrvF1pFkrbdjQeqYU4ekbr4Q04H4nie7WefpTgXFs9qnn9a3xQLDZrAfJLC0zWw0ZYSzbkWazJnGTGR23nVifNK+Ul9q5oPlG10bxzPS7sAbN9BeaaYqt5N70r6RVGGkvKpY4aZrLetIYwkdtuLCUQQFG/1PZ/NgiYfgCztqZg0pAjBiMwI2ZWlVN91qNiUadIa64JsfwklfrIDyJ51lhmvNRB+kZjn1bNtFNvBQ6sa3om9thNOAeHlLhMes1EriOdcS69KAUfub4Ei2ruyiRxDy5qKdsFeAaHlXTHsUzmd+EoRCEzhaRZZz2N/Fbkopg5bmldSf4FNJkCsAYkTs2rIzBTE9eJ7zpiZuIxnJodRsxMTVwnvus/U9+5KZBOxowAAAAASUVORK5CYII=" width="25.5" height="20" /></span><span>:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>lambda_min=lambda_max*0.001;</span></span></div></div></div><div  class = 'S6'><span>Generate evenly spaced 20 tuning parameters under the log-scale:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>lambda_c_list=exp(linspace(log(lambda_min),log(lambda_max),20));</span></span></div></div></div><div  class = 'S6'><span>Perform 5-fold cross validation to choose </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">Î±</span><span> and </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">Î»</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>pred_err=zeros(length(alpha_list),length(lambda_c_list));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:length(alpha_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>j=1:length(lambda_c_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        output=cv_LN_Bern(X,lambda_c_list(j),alpha_list(i),true,init_A,init_nu,eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        pred_err(i,j)=mean(cell2mat(output.pred_err));</span><span style="color: rgb(2, 128, 9);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>[I,J]=find(pred_err==min(pred_err(:)));alpha=alpha_list(I);lambda=lambda_c_list(J)*K*sqrt(log(M)/T);</span></span></div></div></div><div  class = 'S6'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Estimate the parameters:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>[Ah,nu_h,~,~,~,~]=fit_LN_Bern(X,lambda,alpha,true,init_A, init_nu, eta,tol,iter);</span></span></div></div></div><div  class = 'S6'><span>Estimation error:</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre;"><span>sqrt(sum((Ah(:)-A(:)).^2))</span></span></div><div  class = 'S9'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>ans = 2.5604</div></div></div><div class="inlineWrapper outputs"><div  class = 'S10'><span style="white-space: pre;"><span>sqrt(sum((nu_h(:)-nu(:)).^2))</span></span></div><div  class = 'S9'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>ans = 0.8027</div></div></div></div><h2  class = 'S1'><span>Mixture method</span></h2><div  class = 'S2'><span>Assume that some nodes fol</span><span>low the multinomial autoregressive model while others follow the logistic-normal autoregressive model with time-varying event probability. Furthermore, we assume that the true categories of events associated with multinomial nodes are not accurately observed, but contaminated to be logistic-normal random vectors lying on a simplex. This is the setting of the synthetic toy model in our paper that mimics the real data behavior, and more details are included in the paper. We will show in the following how to identify the type of each node (multinomial or logistic-normal), and how to estimate the network parameter based on the their types. The required functions iare included n the folder </span><span style=' font-weight: bold;'>mixture.</span></div><div  class = 'S2'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Generate data:</span></div><div  class = 'S2'><span>Consider the same setting as the two examples above, with first 5 nodes being logistic-normal nodes (</span><span style=' font-family: monospace;'>LN_list</span><span>) and last 5 nodes (</span><span style=' font-family: monospace;'>MN_list</span><span>) being multinomial nodes.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>addpath(</span><span style="color: rgb(170, 4, 249);">'mixture'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>M=10;K=2;rho=1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>rng(2578);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>A_mix=zeros(M,K,M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:M</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    connect=randsample(M,rho);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>k=1:size(connect)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>     A_mix(i,:,connect(k),:)=(rand(K,K)-0.5)*4;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>LN_list=1:5;MN_list=6:10;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>nu_mix=zeros(M,K);prob=0.8;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>nu_mix(MN_list,:)=ones(length(MN_list),K)*log(prob/K/(1-prob));</span></span></div></div></div><div  class = 'S6'><span>First we generate the clean mixture data with sample size </span><span texencoding="T=1000" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAAAkCAYAAACpH0VdAAAEzklEQVR4Xu2aWegXVRTHP38qM8KQcomsQMKIXGhRqbAHK7WMeqj0QcQlEwlaLFxS0jALUXF/6KUSi+ihFZLItIUkijTLpUIohUzUyjBtwbSS758zMkx3fv878x+685vfnJf/MvfcOed855x7lttGTS1jgbaW0bRWlBrsFvoIarBrsFvIAi2kau3ZNdgtZIH/qnoZ8F0GC5wNiKcb8Dlwsqy8aZ7dFVgOuRO4o8DsDEqXYeloYAFwGLjVQ6AzgCeB+4FvgG+Bm4HPgPnArgZ7BOFNA/sWYKMJuxf40IzwO3AHcI09ex34FOgFjAAG2QfyFnCnh8HKsERyC7TrTJgNHmDLbmuBicBY4BXjPRf4BOgNDAe+digYijfVcxcD04AxMdAjub8CrrQ/rga+jCl0I/AB8AiwpgxIdiDDo8AfwHHg+QxgrwYeBF4D7km8Y7A5wM/AEGBf4nko3lSwtwEPA5sTgvYBfrD/HQQuAv5NrNlpX7tCWzPRAeBCoCPPvhzYbYpdb8Am9XzXIt0yYEbsYSjedhFcYbwn8Izji9X6SRa+9PsLFsaSiiq039VMKJusOnOVaHUE9iLgMYsI3YETDl0fBxYCvwAXA3/amlC8qWCfBShBO+ZQ4iVgnP1fP192rFGId51VZcffB2wlVt9bRHsPUG7jIh1nH9mDe81BQvGeli9Lna21Ct1Kxv6xJETnUlXIB+wBgI4pkXKSh1KUP98SWj1WLjAFCMWbC+yrgC+McwswtCooZwjjo4B3bL3CtEosF50ZC++qakYCoXhzgT0TWGKcTwHzCgL7bitTOrudzskjndjEx7Mnx7J2JV5KwNLoN0ClmJK5K4BQvLnA1hcanVHDgI87Ydg46wpgegF7XRKrFPJs5wN2lHhp//uA5xq8aL+d7SrtBHoo3sxgn2OZpRI3eU8P4O88FnXwqHwZWMBeSh7V9MlLPmDPBZ62F6gyWdfgZXuAvtY+7QLMCcR7ujT2TdB05qgkEbkaCXkNXCY+H7CVWUferD6EGiRppLarEjV5uMqvULyZPXtprDkwFXi2TCgVJIsP2LcD6+19T1ib1fV6OZHqb5VbW62TFoo3M9jbre8txksdLcCC7B10Gx+w4xWJcg21W110HvCrPYjmBKF4M4Gtpr5aifpa1SzpXzAkzZSNywZqF6tNrE6hZHeRcpAd9kBzgpVmvxC8mcAeD7xoHI2+5rzfQDNl49JxlTVTfrLGUnI2oDUPWNNFSazOazWjQvK2v9wnQVPGOcGE1XgzOrPygpvka6ZsXLKr7IwGRIpyrtbwq+b1GoiomRJRKF4vsNUnVzap4YhIIf3HolAu2T7R1CsJkEvMaEbginTKaTQGVhftJptvx/cIxduhZ88CNNsWqR+us+pQyUAqQpxrAbWAFek06OgH/NVgY11Fet8uPMhbdWEhIpWourGiOfebjj1C8TrBVgNAbdEbrGSIy6tGwSZAGWbR4bwI0LLuocndbRZy1TiKSMOOt01X6esiRTvV3PLeN+xqkva7wMpUeXAaBeH1ObOzGrDV1msGruxbs21d4dI1Ld188aH/lbcG2weSiqypwa4IkD5q1GD7WKkia2qwKwKkjxo12D5WqsiaGuyKAOmjRg22j5UqsqYGuyJA+qhxCsW7jDQqmPkiAAAAAElFTkSuQmCC" width="61.5" height="18" /></span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>T=1000;sigma_LN=1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>X=data_gen_mixed(M,K,T,A_mix,nu_mix,prob,sigma_LN,LN_list);</span></span></div></div></div><div  class = 'S6'><span>Then we contaminate the data associated to multinomial nodes to be logistic-normally distributed random vectors.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>a=1;sigma_MN=0.3;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>X_contam=contaminate_MN_nodes(X,MN_list,a,sigma_MN);</span></span></div></div></div><div  class = 'S6'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Identify the type of each node:</span></div><div  class = 'S2'><span>Given the contaminated data </span><span style=' font-family: monospace;'>X_contam</span><span>, we use the function </span><span style=' font-family: monospace;'>testing.m</span><span> to identify the type of each node, which outputs a test statistic </span><span style=' font-family: monospace;'>logLR</span><span>. Since we need to fit two models based on the contaminated data in </span><span style=' font-family: monospace;'>testing.m</span><span>, cross validation is also needed. The input </span><span style=' font-family: monospace;'>nlambda</span><span> is the number of potential tuning parameters to conider in cross validation. We can then estimate the set of logistic-normal nodes to be the nodes with test statistic </span><span style=' font-family: monospace;'>logLR </span><span>equal to </span><span style=' font-family: monospace;'>-Inf.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>nlambda=20;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>[logLR,~,~,~,~,~,~]=testing(X_contam,nlambda);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>LN_list_hat=find(logLR==-Inf);MN_list_hat=find(logLR~=-Inf);</span></span></div></div></div><div  class = 'S6'><span>Given the estimated node types, we can preprocess the contaminated data by rounding the event data associated with multinomial nodes.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>X_mix=X_contam;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>m=1:length(MN_list_hat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>t=1:(T+1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">if </span><span>max(X_contam(t,m,:))&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>           [~,I]=sort(X_contam(t,m,:),</span><span style="color: rgb(170, 4, 249);">'descend'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>           X_mix(t,m,I(1))=1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S6'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Cross validation for fitting the mixture model:</span></div><div  class = 'S2'><span>To fit the mixture model based on preprocesse data </span><span style=' font-family: monospace;'>X_mix,</span><span> three tuning parameters are required: </span><span texencoding="\lambda^{LN}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAmCAYAAABtT3M/AAADlElEQVRYR+3Yaah1YxQH8N9rHkPImHmeIxSJDCWkkFmGlA/mlCkZIhk+KDKkfCAiETKkEPlizjxPIWNmmef+Wqd2xz773PPee997ezvr2z77edZe/2f911r/58wxH9ic+QCDMYjZksVxJjoysQCWbnn/E/7s+30RLF6//YUf+973+/rfmunKxBI4FBdi1QrsMtyAz/uCXAvH43T8jNXwXWPNUjgGV+ADnIoHmj6mC0TvG3dhP5yNS4fU0HPYpoK8smXt2zgFD/a/GxXEQtgBr+KbCRR2Tm5NrNKSgeb2JfEM1sFH2Aj/NBYsg3cqq/10HKnFhiKPYnu8ha3waweQDWrdS7W2C/M+2Bkr4ijsgUcaG5LNA3FYm5NRMnFmcfM97FU0uacjspNwFVILZw3J2tW4F99WRu7G/o091+JJ3DxZELfgWPxWHwo3z+8I7n7sjV3x2BAQoee2+KV8b40U/Me1L/WwI76cDIj1i4+Pl5OcblpoukqbLYqvi9fL4/cOEPF9HXavNaHTjbgI51Wd3FY0bnUzCp2aDs7A6jh5QHC7Fafvw75DshDapd5yMLHFKgN/YI3K/sq4YJCfuQWRnr4szhng+PLq+ycgfO6y9Pxz8XxjUQDloA7BwdWe072mNBMZYhlMg3p/OtIWWBfvt3w5fM8QTOBvYu2+lprnd6uYV8KG+HsqQSyMJ4q317Q4zkz4FB9WcbZ9+w4kS9vhiDrx/nWhYlpvOtKRXamcGzrl9NNuj8ZNLc6Pw/V4AekyTYukuLjA7YKASTYuafGzZ03nzIYU9kAbFUQK9iFElB2AyIqmnVgSI1SJvYbP+G+opoZCsWQyfA9NTqvpn04UQE3LnjdKIXSqg1FArICXS0J8XxP04a4TmoJ361VtdLoaBUSPo7dXIUaMPTUFgU7axURB9CREJuYmeLr6f+gy4zYREFtW0JnCBxV3Q6fNS3HOehCZpNH5G+POqoMUZmTEcn2XlxkDMywTaZVpmV8VjUKnaKE8JzNdmmiegeoCkRaa049l/KegY5mmmcK5qPxQAi3aJgNwRmwQiAivF4symQUB1LPN8EpN22drsEWS99+d5xmgNhALlv7fqeT0pviiEVEG2SelNDP4chsbplSnFVAbiJxqT/YejltbIugJvEzSgH19WqMc4nxYYQ/anr9RcufNnTtCb0ZtbkHMaND9Hx+DmC3pGGdinIkpPIExnabwMCfl6l/6Dqsnpu3hkQAAAABJRU5ErkJggg==" width="24.5" height="19" /></span><span>, </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">Î±</span><span> and </span><span texencoding="\lambda^{MN}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAAmCAYAAACPk2hGAAAEQ0lEQVRoQ+3YdahtVRAG8N+zu7tQsVsRRcXCxMRWFBPFVmxRUEQs/MNAMcDAQDFRbLEQu1vsRLHFFoNPZst523Mu5753H+/4uPPPgb3XWWu+mW++mbXHmERtzCSKyyiw/1tmRzM2zIwlYDN1/OdX/DLEHtNhynr/O35C57Nu/58K0/Y6Y0JlbArsipOwCC7DPj2AzY1XMAeew7G4H2viGGyNx7BW6//Z90gchHtq7UvNmgkFrNn/bmyC+7BxD2C3Yiv+EbKV8GLHumT9G0yGlfFCa4958Q4WwNed74YLLJlIJBPhsTbq4nSo8hSWxrv12162B3bGpngbi7cWbIhzsCwuxX6t95tjf2zZ3ng4wML5B7A63qzoDlU3G2AbbIa5MEPr8AVxG67G2bgAB7fW5PkjBS57zI/vOtaci1dxyfgAC/f3qtTH2TgdGvWyOPUwjsI6mK1olfUJaGh6Og7BtkXH21ubPY+1cQDOwmE4r2PNa0X1j8YHWCIbAYhChWJ3lTj0AtY4dVEJyYpoivvAoubh+BLTF/AfOjZLRnPmupgdH+P9Dkrn/Z1YvpsD/VIx3J+vMpB9zsSMiIPdLIdehfUqK8dhC9yBxXBT1eoKpXgPYf3WRvsiinlqPb8ceyIUT0nsjSVLRf/jQ7/A2n+MDEeJDu0BLEWeKIdqAZ/6ye/FCIgTq3ZOrqwfjzNaewV86PdkPV8VT+NmbIfrEDZkvxEDdjRmwQk9gN1SkX62FCsiEZCR7ghAKBhLf1oDqyDUbSzq+1Zl94+O5wGZtYsWoKWQhj5iwE6p6aAd5RyQCeKNcuqvUs84nbqMskZVM1kkMKmvrzAPsraxiE3YsH3L491xZdXWz13e/7t8XKgYxxPpK4pi7WhtVPzfpV6EkgHwZwnBo/U8Shi6XYPdWptEUdPXQrVOmwZRwEwpEbJMNF1tXIAlS5H+FHKi17aIxus4rePFj1VfR3Q8yzSSBpyR6MKO52nsaeg74PEu+zfnh9KfjhSwKNK9NeKkgFPIjWUgPb963XuIMESuY6mxnRD6pEbS25qMRhCSmUR/iWrWmSTynwSnEY/mnIVxIyImPW04GUv604cyn6X7J6KJ+sSwtIxQdUSAZSpIL7q+JvZMAU9MDFT9nNlvxjL2ZJT5AssUPTKRZ04bSOsHWEah8Hxq7IgbiooZZT4cSFQ1jA7lW/rOMzWfpWBTV5H73zArvv2/AssIlPEofSgUDBWbvpQMBuBA2lBUjJwnS7FcBiMasVzJ02dmxvc13mRySNMeGOsFbKG6hoduzdDZOL0cXsZqNZQmq/m28dnAoOpRY5PjwbrgZY7LtfzzDqdzffmk7kdp1nPWJXGQcHX9EpzoZ2qI5UvTtV08zgeX3KXy3SM33NxkB8r6kftuDuf7RRQyF74PBgpROTOuwAYRy1g+jQIb+BS1HBzN2GjGBiQCo1QckET07cbf5grWJ4ogVGUAAAAASUVORK5CYII=" width="27" height="19" /></span><span>. The first two are determined by cross validation on the logistic-normal nodes, while the last one is determinied by cross validation on the multinomial node.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>init_nu=zeros(M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>init_A=zeros(M,K,M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>eta=2;tol=0.0001;iter=500;</span></span></div></div></div><div  class = 'S6'><span>Cross validation for logistic-normal nodes:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>lambda_c_LN_max=0.01;stop=false;alpha_list=[0.3 0.5 0.7];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:length(alpha_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">while </span><span>~stop</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        lambda=lambda_c_LN_max*K*sqrt(log(M)/T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        Ah=zeros(M,K,M,K);nu_h=zeros(M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">for </span><span>m=LN_list_hat</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            [Ah(m,:,:,:),nu_h(m,:),~,~,~,~]=fit_LN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda,alpha_list(i),true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">if </span><span>sum(Ah(:).^2)&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            lambda_c_LN_max=lambda_c_LN_max*2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            init_A=Ah;init_nu=nu_h;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            stop=true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>lambda_c_LN_min=lambda_c_LN_max*0.001;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>lambda_c_LN_list=exp(linspace(log(lambda_c_LN_min),log(lambda_c_LN_max),20));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>pred_err_LN=zeros(length(LN_list_hat),length(alpha_list),length(lambda_c_LN_list));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:length(LN_list_hat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    m=LN_list_hat(i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>j1=1:length(alpha_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">for </span><span>j2=1:length(lambda_c_LN_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            output=cv_LN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda_c_LN_list(j2),alpha_list(j1),true,init_A(m,:,:,:),init_nu(m,:),eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            pred_err_LN(i,j1,j2)=mean(cell2mat(output.pred_err));  </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            Ah_temp=zeros(1,K,M,K);nu_h_temp=zeros(1,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            </span><span style="color: rgb(14, 0, 255);">for </span><span>k=1:5</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>                Ah_temp(1,:,:,:)=Ah_temp(1,:,:,:)+output.Ah{k};</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>                nu_h_temp(1,:)=nu_h_temp(1,:)+output.nu_h{k};</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            init_A(m,:,:,:)=Ah_temp/5;init_nu(m,:)=nu_h_temp/5;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>pred_err_LN=reshape(mean(pred_err_LN,1),length(alpha_list),length(lambda_c_LN_list));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>[I,J]=find(pred_err_LN==min(pred_err_LN(:)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>LN_alpha=alpha_list(I);</span><span class="variableHighlight">LN_lambda_c</span><span>=lambda_c_LN_list(J);</span></span></div></div></div><div  class = 'S6'><span>Cross validation for MN nodes</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>lambda_c_MN_max=0.01;stop=false;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">while </span><span>~stop</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    lambda=lambda_c_MN_max*K*sqrt(log(M)/T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    Ah=zeros(M,K,M,K);nu_h=zeros(M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>m=MN_list_hat</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        [Ah(m,:,:,:),nu_h(m,:),~,~,~,~]=fit_MN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda,true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">if </span><span>sum(Ah(:).^2)&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        lambda_c_MN_max=lambda_c_MN_max*2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        init_A=Ah;init_nu=nu_h;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        stop=true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>lambda_c_MN_min=lambda_c_MN_max*0.001;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>lambda_c_MN_list=exp(linspace(log(lambda_c_MN_min),log(lambda_c_MN_max),20));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>pred_err_MN=zeros(length(MN_list_hat),length(lambda_c_MN_list));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:length(MN_list_hat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    m=MN_list_hat(i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>j=1:length(lambda_c_MN_list)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        output=cv_MN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda_c_MN_list(j),true,init_A(m,:,:,:),init_nu(m,:),eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        pred_err_MN(i,j)=mean(cell2mat(output.pct_err));  </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        Ah_temp=zeros(1,K,M,K);nu_h_temp=zeros(1,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">for </span><span>k=1:5</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            Ah_temp(1,:,:,:)=Ah_temp(1,:,:,:)+output.Ah{k};</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>            nu_h_temp(1,:)=nu_h_temp(1,:)+output.nu_h{k};</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        init_A(m,:,:,:)=Ah_temp/5;init_nu(m,:)=nu_h_temp/5;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>[~,ind]=min(mean(pred_err_MN,1)); </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>MN_lambda_c=lambda_c_MN_list(ind);</span></span></div></div></div><div  class = 'S6'><span style=' font-weight: bold; font-style: italic; text-decoration: underline;'>Estimate the parameters:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>LN_lambda=</span><span class="variableHighlight">LN_lambda_c</span><span>*K*sqrt(log(M)/T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>MN_lambda=MN_lambda_c*K*sqrt(log(M)/T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>Ah_mix=zeros(M,K,M,K);nu_h_mix=zeros(M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>init_A=zeros(M,K,M,K);init_nu=zeros(M,K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>m=1:M</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">if </span><span>sum(LN_list_hat==m)&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        [Ah_mix(m,:,:,:),nu_h_mix(m,:),~,~,~,~]=fit_LN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),LN_lambda,LN_alpha,true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>        [Ah_mix(m,:,:,:),nu_h_mix(m,:),~,~,~,~]=fit_MN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),MN_lambda,true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S6'><span>Estimation error:</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre;"><span>sqrt(sum((Ah_mix(:)-A_mix(:)).^2))</span></span></div><div  class = 'S9'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>ans = 5.0571</div></div></div><div class="inlineWrapper outputs"><div  class = 'S10'><span style="white-space: pre;"><span>sqrt(sum((nu_h_mix(:)-nu_mix(:)).^2))</span></span></div><div  class = 'S9'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>ans = 0.9574</div></div></div></div><h2  class = 'S1'></h2></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Estimating context-dependent network in autoregressive point process models
%% Introduction
% This is a tutorial for how to use the MATLAB functions in this folder to conduct 
% estimation for context-dependent networks from time series data, based on autoregressive 
% point process modeling. The methodologies are proposed in the paper <https://arxiv.org/abs/2003.07429 
% Context-dependent self-exciting point processes: models, methods, and risk bounds 
% in high dimensions>, including a multinomial approach which assumes a multinomial 
% autoregressive model, a logistic-normal approach that assumes a logistic-normal 
% autoregressive model, and a mixture approach assuming some nodes in the network 
% follow the multinomial model while others follw the logistic-normal model. 
% 
% In this tutorial, we illustrate how to apply the multinomial, logistic-normal 
% and mixture approaches through some examples.
%% Multinomial method
% Assume that the time series data $\{X^t\in R^{M\times K}\}_{t=0}^T$ follow 
% the multinomial autoregressive model defined in the paper, with network parameter 
% $A^{MN}\in R^{M\times K\times M\times K}$ and offset parameter $\nu^{MN}\in 
% R^{M\times K}$, then we can estimate$A^{MN}$ and $\nu^{MN}$ by applying the 
% functions in the folder *multinomial.*
% 
% _*Generate data:*_
% 
% First we consider an example with $M=10$ nodes, and $K=2$ categories, each 
% node is influenced by $\rho=1$ randomly chosen node. Each edge weight follows 
% uniform distribution $U(-2,2)$, and the offset parameter is set to ensure the 
% event probability to be |prob=0.8| when no past influence exists.

addpath('multinomial')
M=10;K=2;rho=1;
rng(2578);
A=zeros(M,K,M,K);
for i=1:M
    connect=randsample(M,rho);
    for k=1:size(connect)
     A(i,:,connect(k),:)=(rand(K,K)-0.5)*4;
    end
end
prob=0.8;
nu=ones(M,K)*log(prob/K/(1-prob));
%% 
% Then we generate multinomial time series data $\{X^t\}_{t=0}^T$ with sample 
% size $T=1000$.

T=1000;
X=data_gen_MN(M,K,T,A,nu,prob);
%% 
% _*Cross validation:*_
% 
% Given data$\{X^t\}_{t=0}^T$, we can run 5-fold cross validation using function 
% |cv_MN.m|. First we need to specify a list of tuning parameters for us to choose 
% from. We can let the largest one $\lambda_{\max}$ to be the smallest $\lambda$ 
% leading to zero estimate for $A^{MN}$, and then set the smallest one $\lambda_{\min}$ 
% to be $0.001\times \lambda_{\max}$. We then choose the list of tuning parameters 
% to be equally spaced between $\lambda_{\min}$ and $\lambda_{\max}$ under the 
% log-scale.

init_nu=zeros(M,K);
init_A=zeros(M,K,M,K);
eta=2;tol=0.0001;iter=500;
%% 
% Choose $\lambda_{\max}$:

lambda_max=0.01;stop=false;
while ~stop
    lambda=lambda_max*K*sqrt(log(M)/T);
    [Ah,~,~,~,~,~]=fit_MN(X,lambda,true,init_A, init_nu, eta,tol,iter);
    if sum(Ah(:).^2)>0
        lambda_max=lambda_max*2;
    else
        stop=true;
    end
end
%% 
% Choose $\lambda_{\min}$:

lambda_min=lambda_max*0.001;
%% 
% Generate evenly spaced 20 tuning parameters under the log-scale:

lambda_c_list=exp(linspace(log(lambda_min),log(lambda_max),20));
%% 
% Given the list of tuning parameters, we run 5-fold cross validation:

pred_err=zeros(1,length(lambda_c_list));pred_loss=zeros(1,length(lambda_c_list));
for i=1:length(lambda_c_list)
    output=cv_MN(X,lambda_c_list(i),true,init_A,init_nu,eta,tol,iter);
    pred_loss(i)=mean(cell2mat(output.pred_loss));
    pred_err(i)=mean(cell2mat(output.pred_err));
end  
%% 
% |pred_loss| and |pred_err| contain the average log-likelihood loss and prediction 
% errors evaluated at the test sets in 5-fold cross validation, and either one 
% can be used as the criterion for choosing lambda.

[~,I]=min(pred_loss);
%% 
% _*Estimate the parameters:*_

lambda=lambda_c_list(I)*K*sqrt(log(M)/T);
[Ah,nu_h,~,~,~,~]=fit_MN(X,lambda,true,init_A, init_nu, eta,tol,iter);
%% 
% Estimation error:

sqrt(sum((Ah(:)-A(:)).^2))
sqrt(sum((nu_h(:)-nu(:)).^2))
%% Logistic-normal method
% Assume that the time series data $\{X^t\in R^{M\times K}\}_{t=0}^T$ follow 
% the logistic-normal autoregressive model with event probability varying over 
% time, where the network parameters are$A^{LN}\in R^{M\times (K-1)\times M\times 
% K}$, $B^{Bern}\in R^{M\times 1\times M\times K}$ and offset parameters are $\nu^{LN}\in 
% R^{M\times (K-1)}$, $\eta^{Bern}\in R^{M\times 1}$. We can estimate these parameters 
% by applying the functions in the folder *logistic-normal-varying-q.* For simplicity 
% of the codes, we will use only two parameters |A| and |nu|, where |A| is concatenated 
% by $A^{LN}$ and $B^{Bern}$ in the second dimension, |nu| is concatenated by 
% $\nu^{LN}$ and $\eta^{Bern}$in the second dimension. When assuming the event 
% probability for each node is a constant ($B^{Bern}=0$), the functions in folder 
% *logistic-normal-constant-q* can be used, while for presentation simplicity 
% we will omit this special case.
% 
% _*Generate data:*_
% 
% Consider the same setting as the multinomial example above, and the standard 
% deviation for the Gaussian noise in logistic-normal model is set as $\sigma=1$.

addpath('logistic-normal-varying-q')
M=10;K=2;rho=1;
rng(2578);
A=zeros(M,K,M,K);
for i=1:M
    connect=randsample(M,rho);
    for k=1:size(connect)
     A(i,:,connect(k),:)=(rand(K,K)-0.5)*4;
    end
end
prob=0.8;
nu=zeros(M,K);nu(:,K)=ones(M,1)*log(prob/(1-prob));sigma=1;
%% 
% Then we generate logistic-normal time series data $\{X^t\}_{t=0}^T$ with sample 
% size $T=1000$.

T=1000;
X=data_gen_LN_Bern(M,K,T,A,nu,prob,sigma);
%% 
% _*Cross validation:*_
% 
% Specify the list of tuning parameters to choose from, including a list of 
% $\alpha$ and a list of $\lambda$.

init_nu=zeros(M,K);
init_A=zeros(M,K,M,K);
eta=2;tol=0.0001;iter=500;
%% 
% Choose $\lambda_{\max}$:

lambda_max=0.01;stop=false;alpha_list=[0.3 0.5 0.7];
for i=1:length(alpha_list)
    while ~stop
        lambda=lambda_max*K*sqrt(log(M)/T);
        [Ah,nu_h,~,~,~,~]=fit_LN_Bern(X,lambda,alpha_list(i),true,init_A, init_nu, eta,tol,iter);
        if sum(Ah(:).^2)>0
            lambda_max=lambda_max*2;
            init_A=Ah;init_nu=nu_h;
        else
            stop=true;
        end
    end
end
%% 
% Choose $\lambda_{\min}$:

lambda_min=lambda_max*0.001;
%% 
% Generate evenly spaced 20 tuning parameters under the log-scale:

lambda_c_list=exp(linspace(log(lambda_min),log(lambda_max),20));
%% 
% Perform 5-fold cross validation to choose $\alpha$ and $\lambda$.

pred_err=zeros(length(alpha_list),length(lambda_c_list));
for i=1:length(alpha_list)
    for j=1:length(lambda_c_list)
        output=cv_LN_Bern(X,lambda_c_list(j),alpha_list(i),true,init_A,init_nu,eta,tol,iter);
        pred_err(i,j)=mean(cell2mat(output.pred_err));%
    end
end
[I,J]=find(pred_err==min(pred_err(:)));alpha=alpha_list(I);lambda=lambda_c_list(J)*K*sqrt(log(M)/T);
%% 
% _*Estimate the parameters:*_

[Ah,nu_h,~,~,~,~]=fit_LN_Bern(X,lambda,alpha,true,init_A, init_nu, eta,tol,iter);
%% 
% Estimation error:

sqrt(sum((Ah(:)-A(:)).^2))
sqrt(sum((nu_h(:)-nu(:)).^2))
%% Mixture method
% Assume that some nodes follow the multinomial autoregressive model while others 
% follow the logistic-normal autoregressive model with time-varying event probability. 
% Furthermore, we assume that the true categories of events associated with multinomial 
% nodes are not accurately observed, but contaminated to be logistic-normal random 
% vectors lying on a simplex. This is the setting of the synthetic toy model in 
% our paper that mimics the real data behavior, and more details are included 
% in the paper. We will show in the following how to identify the type of each 
% node (multinomial or logistic-normal), and how to estimate the network parameter 
% based on the their types. The required functions iare included n the folder 
% *mixture.*
% 
% _*Generate data:*_
% 
% Consider the same setting as the two examples above, with first 5 nodes being 
% logistic-normal nodes (|LN_list|) and last 5 nodes (|MN_list|) being multinomial 
% nodes.

addpath('mixture')
M=10;K=2;rho=1;
rng(2578);
A_mix=zeros(M,K,M,K);
for i=1:M
    connect=randsample(M,rho);
    for k=1:size(connect)
     A_mix(i,:,connect(k),:)=(rand(K,K)-0.5)*4;
    end
end
LN_list=1:5;MN_list=6:10;
nu_mix=zeros(M,K);prob=0.8;
nu_mix(MN_list,:)=ones(length(MN_list),K)*log(prob/K/(1-prob));
%% 
% First we generate the clean mixture data with sample size $T=1000$.

T=1000;sigma_LN=1;
X=data_gen_mixed(M,K,T,A_mix,nu_mix,prob,sigma_LN,LN_list);
%% 
% Then we contaminate the data associated to multinomial nodes to be logistic-normally 
% distributed random vectors.

a=1;sigma_MN=0.3;
X_contam=contaminate_MN_nodes(X,MN_list,a,sigma_MN);
%% 
% _*Identify the type of each node:*_
% 
% Given the contaminated data |X_contam|, we use the function |testing.m| to 
% identify the type of each node, which outputs a test statistic |logLR|. Since 
% we need to fit two models based on the contaminated data in |testing.m|, cross 
% validation is also needed. The input |nlambda| is the number of potential tuning 
% parameters to conider in cross validation. We can then estimate the set of logistic-normal 
% nodes to be the nodes with test statistic |logLR| equal to |-Inf.|

nlambda=20;
[logLR,~,~,~,~,~,~]=testing(X_contam,nlambda);
LN_list_hat=find(logLR==-Inf);MN_list_hat=find(logLR~=-Inf);
%% 
% Given the estimated node types, we can preprocess the contaminated data by 
% rounding the event data associated with multinomial nodes.

X_mix=X_contam;
for m=1:length(MN_list_hat)
    for t=1:(T+1)
        if max(X_contam(t,m,:))>0
           [~,I]=sort(X_contam(t,m,:),'descend');
           X_mix(t,m,I(1))=1;
        end
    end
end
%% 
% _*Cross validation for fitting the mixture model:*_
% 
% To fit the mixture model based on preprocesse data |X_mix,| three tuning parameters 
% are required: $\lambda^{LN}$, $\alpha$ and $\lambda^{MN}$. The first two are 
% determined by cross validation on the logistic-normal nodes, while the last 
% one is determinied by cross validation on the multinomial node.

init_nu=zeros(M,K);
init_A=zeros(M,K,M,K);
eta=2;tol=0.0001;iter=500;
%% 
% Cross validation for logistic-normal nodes:

lambda_c_LN_max=0.01;stop=false;alpha_list=[0.3 0.5 0.7];
for i=1:length(alpha_list)
    while ~stop
        lambda=lambda_c_LN_max*K*sqrt(log(M)/T);
        Ah=zeros(M,K,M,K);nu_h=zeros(M,K);
        for m=LN_list_hat
            [Ah(m,:,:,:),nu_h(m,:),~,~,~,~]=fit_LN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda,alpha_list(i),true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);
        end
        if sum(Ah(:).^2)>0
            lambda_c_LN_max=lambda_c_LN_max*2;
            init_A=Ah;init_nu=nu_h;
        else
            stop=true;
        end
    end
end
lambda_c_LN_min=lambda_c_LN_max*0.001;
lambda_c_LN_list=exp(linspace(log(lambda_c_LN_min),log(lambda_c_LN_max),20));
pred_err_LN=zeros(length(LN_list_hat),length(alpha_list),length(lambda_c_LN_list));
for i=1:length(LN_list_hat)
    m=LN_list_hat(i);
    for j1=1:length(alpha_list)
        for j2=1:length(lambda_c_LN_list)
            output=cv_LN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda_c_LN_list(j2),alpha_list(j1),true,init_A(m,:,:,:),init_nu(m,:),eta,tol,iter);
            pred_err_LN(i,j1,j2)=mean(cell2mat(output.pred_err));  
            Ah_temp=zeros(1,K,M,K);nu_h_temp=zeros(1,K);
            for k=1:5
                Ah_temp(1,:,:,:)=Ah_temp(1,:,:,:)+output.Ah{k};
                nu_h_temp(1,:)=nu_h_temp(1,:)+output.nu_h{k};
            end
            init_A(m,:,:,:)=Ah_temp/5;init_nu(m,:)=nu_h_temp/5;
        end
    end
end
pred_err_LN=reshape(mean(pred_err_LN,1),length(alpha_list),length(lambda_c_LN_list));
[I,J]=find(pred_err_LN==min(pred_err_LN(:)));
LN_alpha=alpha_list(I);LN_lambda_c=lambda_c_LN_list(J);
%% 
% Cross validation for MN nodes

lambda_c_MN_max=0.01;stop=false;
while ~stop
    lambda=lambda_c_MN_max*K*sqrt(log(M)/T);
    Ah=zeros(M,K,M,K);nu_h=zeros(M,K);
    for m=MN_list_hat
        [Ah(m,:,:,:),nu_h(m,:),~,~,~,~]=fit_MN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda,true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);
    end
    if sum(Ah(:).^2)>0
        lambda_c_MN_max=lambda_c_MN_max*2;
        init_A=Ah;init_nu=nu_h;
    else
        stop=true;
    end
end
lambda_c_MN_min=lambda_c_MN_max*0.001;
lambda_c_MN_list=exp(linspace(log(lambda_c_MN_min),log(lambda_c_MN_max),20));
pred_err_MN=zeros(length(MN_list_hat),length(lambda_c_MN_list));
for i=1:length(MN_list_hat)
    m=MN_list_hat(i);
    for j=1:length(lambda_c_MN_list)
        output=cv_MN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),lambda_c_MN_list(j),true,init_A(m,:,:,:),init_nu(m,:),eta,tol,iter);
        pred_err_MN(i,j)=mean(cell2mat(output.pct_err));  
        Ah_temp=zeros(1,K,M,K);nu_h_temp=zeros(1,K);
        for k=1:5
            Ah_temp(1,:,:,:)=Ah_temp(1,:,:,:)+output.Ah{k};
            nu_h_temp(1,:)=nu_h_temp(1,:)+output.nu_h{k};
        end
        init_A(m,:,:,:)=Ah_temp/5;init_nu(m,:)=nu_h_temp/5;
    end
end
[~,ind]=min(mean(pred_err_MN,1)); 
MN_lambda_c=lambda_c_MN_list(ind);
%% 
% _*Estimate the parameters:*_

LN_lambda=LN_lambda_c*K*sqrt(log(M)/T);
MN_lambda=MN_lambda_c*K*sqrt(log(M)/T);
Ah_mix=zeros(M,K,M,K);nu_h_mix=zeros(M,K);
init_A=zeros(M,K,M,K);init_nu=zeros(M,K);
for m=1:M
    if sum(LN_list_hat==m)>0
        [Ah_mix(m,:,:,:),nu_h_mix(m,:),~,~,~,~]=fit_LN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),LN_lambda,LN_alpha,true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);
    else
        [Ah_mix(m,:,:,:),nu_h_mix(m,:),~,~,~,~]=fit_MN_node(X_mix(1:T,:,:),X_mix(2:(T+1),m,:),MN_lambda,true,init_A(m,:,:,:), init_nu(m,:), eta,tol,iter);
    end
end
%% 
% Estimation error:

sqrt(sum((Ah_mix(:)-A_mix(:)).^2))
sqrt(sum((nu_h_mix(:)-nu_mix(:)).^2))
%%
##### SOURCE END #####
--></body></html>